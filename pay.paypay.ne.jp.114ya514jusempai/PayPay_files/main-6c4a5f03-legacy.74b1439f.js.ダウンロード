"use strict";(self["webpackChunkpaypay_web"]=self["webpackChunkpaypay_web"]||[]).push([[9059],{21309:function(e,t,n){var i,o,r,a,s;n.d(t,{ir:function(){return r},j0:function(){return a},ms:function(){return o},xO:function(){return s}}),function(e){e["PAGE_VIEW"]="page_view"}(i||(i={})),function(e){e["AMAZON_ACC_LINK"]="amazon_account_linking"}(o||(o={})),function(e){e["REDIRECT_BACK"]="redirect_back",e["ACCOUNT_SUCCESS"]="account_success",e["ENTER_KYC_HELP"]="enter_kyc_help",e["TAP_KYC_HELP"]="help_tapped"}(r||(r={})),function(e){e["PP_ACCOUNT_LINKED_ERR"]="paypay_account_already_linked_error",e["AMZ_ACCOUNT_LINKED_ERR"]="amazon_account_already_linked_error",e["KYC_ERR"]="kyc_error",e["RISK_ERR"]="risk_error",e["PERMISSION_SCREEN"]="permission_screen",e["TIMEOUT_ERR"]="timeout_error",e["GENERAL_ERROR"]="general_error"}(a||(a={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["APP"]="APP"}(s||(s={}))},30714:function(e,t,n){var i,o,r,a,s,c,l,d,u,E,I,S,A,p,_,T,C,N,R,m,P,f,D,O,y,L,g,U,v,M,h,k,b,G;n.d(t,{C0:function(){return E},D9:function(){return M},D_:function(){return v},EA:function(){return y},F5:function(){return G},Mw:function(){return A},Re:function(){return d},Sj:function(){return r},ZN:function(){return u},_3:function(){return h},d6:function(){return f},eB:function(){return i},eq:function(){return p},fs:function(){return O},l9:function(){return b},mX:function(){return C},qh:function(){return _},ug:function(){return T},yB:function(){return S}}),function(e){e["ORDINARY"]="ORDINARY"}(i||(i={})),function(e){e["SUCCESS"]="SUCCESS",e["PENDING"]="PENDING",e["FAILED"]="FAILED"}(o||(o={})),function(e){e["JPY"]="JPY"}(r||(r={})),function(e){e["AMEX"]="A",e["DINERS"]="D",e["JCB"]="J",e["MASTER"]="M",e["UNION"]="O",e["VISA"]="V"}(a||(a={})),function(e){e["JCB"]="JCB",e["MASTER"]="MASTER",e["VISA"]="VISA"}(s||(s={})),function(e){e["COMPLETED"]="COMPLETED",e["NOT_APPLIED"]="NOT_APPLIED"}(c||(c={})),function(e){e["INVALID_PHONE_NUMBER"]="INVALID_PHONE_NUMBER",e["NG"]="NG",e["NOT_EXIST"]="NOT_EXIST",e["OK"]="OK",e["SMS"]="SMS"}(l||(l={})),function(e){e["CREATED"]="CREATED",e["FAILED"]="FAILED",e["PENDING"]="PENDING",e["SUCCESS"]="SUCCESS"}(d||(d={})),function(e){e["ACQUIRING"]="ACQUIRING",e["CASHBACK"]="CASHBACK",e["REFUND"]="REFUND",e["P2PRECEIVE"]="P2PRECEIVE",e["P2PSEND"]="P2PSEND",e["PAYOUT"]="PAYOUT",e["TOPUP"]="TOPUP",e["TOPUPREVERT"]="TOPUPREVERT",e["PRE_AUTH"]="PRE_AUTH",e["REMITTANCE"]="REMITTANCE"}(u||(u={})),function(e){e["C2B_REMITTANCE_OFFLINE"]="C2B_REMITTANCE_OFFLINE"}(E||(E={})),function(e){e["TRANSACTION"]="TRANSACTION",e["P2P"]="P2P",e["P2PSEND"]="P2PSEND",e["P2PRECEIVE"]="P2PRECEIVE"}(I||(I={})),function(e){e["ACTIVATED"]="ACTIVATED",e["OFF"]="OFF",e["APPLYING"]="APPLYING",e["MAINTENANCE"]="MAINTENANCE",e["SUSPENDED"]="SUSPENDED"}(S||(S={})),function(e){e["ACTIVATED"]="ACTIVATED",e["APPLYING"]="APPLYING",e["BUSY"]="BUSY",e["MAINTENANCE"]="MAINTENANCE",e["NO_BALANCE"]="NO_BALANCE",e["OFF"]="OFF",e["SUSPENDED"]="SUSPENDED"}(A||(A={})),function(e){e["BANK"]="BANK",e["CREDIT_CARD"]="CREDIT_CARD",e["GIFT_CARD"]="GIFT_CARD",e["MERCHANT"]="MERCHANT",e["SBID_CARRIER_BILLING"]="SBID_CARRIER_BILLING",e["WALLET"]="WALLET",e["YMONEY_BALANCE"]="YMONEY_BALANCE",e["YMONEY_BANK"]="YMONEY_BANK",e["PAY_LATER_CC"]="PAY_LATER_CC",e["POINT"]="POINT",e["GIFT_VOUCHER"]="GIFT_VOUCHER",e["NONE"]="NONE"}(p||(p={})),function(e){e["PAYMENT"]="PAYMENT",e["HOME_BARCODE"]="HOME_BARCODE",e["BALANCE_HISTORY"]="BALANCE_HISTORY",e["RECEIPT"]="RECEIPT",e["BARCODE"]="BARCODE",e["TOPUP"]="TOPUP",e["SEVEN_BANK"]="SEVEN_BANK",e["ATM_TOPUP"]="ATM_TOPUP",e["P2P"]="P2P",e["GIFT_CARD"]="GIFT_CARD",e["NOTIFICATION"]="NOTIFICATION",e["BILL_PAYMENT"]="BILL_PAYMENT",e["YMONEY_MIGRATION"]="YMONEY_MIGRATION",e["WEB_PAYMENT"]="WEB_PAYMENT",e["SDK_BARCODE_PAYMENT"]="SDK_BARCODE_PAYMENT"}(_||(_={})),function(e){e["DISABLED"]="DISABLED",e["ENABLED"]="ENABLED",e["NOT_SETUP"]="NOT_SETUP"}(T||(T={})),function(e){e["GRAY"]="GRAY",e["GREEN"]="GREEN",e["RED"]="RED",e["YELLOW"]="YELLOW"}(C||(C={})),function(e){e["TOPUP"]="TOPUP",e["ACQUIRING"]="ACQUIRING",e["REFUND"]="REFUND",e["CASHBACK"]="CASHBACK",e["PAYOUT"]="PAYOUT",e["P2PSEND"]="P2PSEND",e["P2PRECEIVE"]="P2PRECEIVE",e["PRE_AUTH"]="PRE_AUTH"}(N||(N={})),function(e){e["CREDIT_CARD"]="CREDIT_CARD",e["WALLET"]="WALLET",e["BANK"]="BANK",e["SEVEN_BANK"]="SEVEN_BANK",e["YAHOO_AUCTION"]="YAHOO_AUCTION",e["GIFT_CARD"]="GIFT_CARD",e["SBID_CARRIER_BILLING"]="SBID_CARRIER_BILLING",e["YMONEY_BALANCE"]="YMONEY_BALANCE"}(R||(R={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["PENDING"]="PENDING",e["CREATED"]="CREATED",e["EXPIRED"]="EXPIRED",e["CANCELED"]="CANCELED",e["AUTHORIZED"]="AUTHORIZED"}(m||(m={})),function(e){e["GREEN"]="GREEN",e["RED"]="RED",e["YELLOW"]="YELLOW",e["GRAY"]="GRAY"}(P||(P={})),function(e){e["STATIC_QR"]="STATIC_QR",e["DYNAMIC_QR"]="DYNAMIC_QR",e["ONE_TIME_CODE"]="ONE_TIME_CODE",e["PENDING_PAYMENT"]="PENDING_PAYMENT",e["BILL_PAYMENT"]="BILL_PAYMENT",e["TOPUP"]="TOPUP",e["WEB_TOPUP"]="WEB_TOPUP",e["AUTO_TOPUP"]="AUTO_TOPUP",e["P2P"]="P2P",e["SPLIT_BILL"]="SPLIT_BILL",e["OFFLINE_REMITTANCE"]="OFFLINE_REMITTANCE"}(f||(f={})),function(e){e["MAIN"]="MAIN",e["MORE"]="MORE"}(D||(D={})),function(e){e["YJ_CARD"]="YJ_CARD",e["PP_CARD"]="PP_CARD"}(O||(O={})),function(e){e["SBID_MAINTENANCE"]="SBID_MAINTENANCE"}(y||(y={})),function(e){e["FUTURE"]="FUTURE",e["ONGOING"]="ONGOING"}(L||(L={})),function(e){e["DAILY"]="DAILY",e["MONTHLY"]="MONTHLY"}(g||(g={})),function(e){e["CASHIER"]="CASHIER",e["OFFLINE_DONATION"]="OFFLINE_DONATION"}(U||(U={})),function(e){e["ACQUIRING"]="ACQUIRING",e["TOPUP"]="TOPUP",e["TOPUP_AND_PAY"]="TOPUP_AND_PAY",e["REMITTANCE"]="REMITTANCE",e["P2P"]="P2P"}(v||(v={})),function(e){e["MANUAL_TOPUP"]="MANUAL_TOPUP",e["TOPUP_AND_PAY"]="TOPUP_AND_PAY"}(M||(M={})),function(e){e["REGULAR"]="REGULAR",e["GOLD"]="GOLD"}(h||(h={})),function(e){e["ALL"]="ALL",e["PAYROLL_ENABLED"]="PAYROLL_ENABLED"}(k||(k={})),function(e){e["SIGNIN"]="SIGNIN",e["SIGNUP"]="SIGNUP"}(b||(b={})),function(e){e["ANNOUNCEMENT_CC_STEP_UNAVAILABLE"]="ANNOUNCEMENT_CC_STEP_UNAVAILABLE",e["PROMOTION_PAYLATER_OTHER_CREDIT_CARD"]="PROMOTION_PAYLATER_OTHER_CREDIT_CARD",e["OVERDRAFT"]="OVERDRAFT"}(G||(G={}))},86473:function(e,t,n){var i,o;n.d(t,{D:function(){return i}}),function(e){e["SUCCESS"]="SUCCESS",e["ERROR"]="ERROR"}(i||(i={})),function(e){e["COMPLETED"]="COMPLETED",e["REJECTED"]="REJECTED",e["PENDING"]="PENDING",e["TRANSFERRED"]="TRANSFERRED"}(o||(o={}))},48418:function(e,t,n){var i,o,r;n.d(t,{T5:function(){return i},Y_:function(){return r}}),function(e){e["CREATED"]="CREATED",e["FAILED"]="FAILED",e["PENDING"]="PENDING",e["SUCCESS"]="SUCCESS",e["REJECTED"]="REJECTED",e["EXPIRED"]="EXPIRED"}(i||(i={})),function(e){e["DEFAULT"]="default",e["POCHIBUKURO"]="pochibukuro",e["OTOSHIDAMA"]="otoshidama"}(o||(o={})),function(e){e["IOS"]="ios",e["ANDROID"]="android"}(r||(r={}))},41553:function(e,t,n){var i,o;n.d(t,{$:function(){return i}}),function(e){e["GOOGLE"]="google",e["OTP"]="otp",e["PASSWORD"]="password",e["PASSWORDLESS"]="passwordless",e["SOFTBANK"]="softbank",e["YAHOO"]="yahoo"}(i||(i={})),function(e){e["COVID_TOKYO_NOTIFICATION"]="COVID_TOKYO_NOTIFICATION",e["ROOTED_DEVICE"]="ROOTED_DEVICE",e["SBID_CARRIER_BILLING"]="SBID_CARRIER_BILLING"}(o||(o={}))},84674:function(e,t,n){n.d(t,{Pj:function(){return s},xC:function(){return a},zs:function(){return r}});var i=n(39050),o=n(46770);const r={OPENAPI:"openApi",OPAWEB:"opaWeb",ACCOUNTLINKAGE:"accountLinkage",OTP:"otp",OPAAMAZON:"opaAmazon",OPAALIPAY:"opaAliPay",OPA_SMART_PAYMENT:"opaSmartPayment",CASHIER:"cashier",OPAOAUTH2:"opaOauth2"},a=()=>(0,i.$t)(""),s=e=>(0,i.$t)(o.A,e)},46770:function(e,t,n){n.d(t,{A:function(){return k}});var i,o=n(75805),r=(n(23500),n(62953),n(85471)),a=n(95353),s=n(55373),c=n.n(s),l=n(96470),d=n(80760),u=n(24909),E=n(27685),I=n(25618),S=n(75005),A=n(56060),p=n(72455),_=n(48008),T=n(89504),C=n(11263),N=n(67034),R=n(55222);(function(e){e["PAYPAY_WALLET"]="pay_by_wallet",e["PAYPAY_CARD_PAYLATER"]="pay_by_pay-later_pp-physical-card"})(i||(i={}));const m={isLinked:!1,isLoading:!1,currentPayPayRate:void 0,currentPaylaterCardRate:void 0},P={loading(e,t){e.isLoading=t},updatePayPayRate(e,t){e.currentPayPayRate=t},updatePaylaterCardRate(e,t){e.currentPaylaterCardRate=t}},f={load({commit:e,dispatch:t}){return(0,o.A)((function*(){e("loading",!0),yield t("loadPayPayData"),e("loading",!1)}))()},loadPayPayData({commit:e}){return(0,o.A)((function*(){const[t,n]=yield(0,R.s)();var o,r;t&&n&&(null===n||void 0===n||null===(o=n.data)||void 0===o||null===(r=o.current_month)||void 0===r||r.campaigns.forEach((t=>{var n,o;((null===t||void 0===t?void 0:t.name)===i.PAYPAY_WALLET&&e("updatePayPayRate",null===t||void 0===t?void 0:t.eligible_rate),(null===t||void 0===t?void 0:t.name)===i.PAYPAY_CARD_PAYLATER)&&e("updatePaylaterCardRate",null!==(n=t.condition)&&void 0!==n&&null!==(o=n.gold_card)&&void 0!==o&&o.fulfilled?t.eligible_gold_rate:t.eligible_rate)})))}))()}},D={namespaced:!0,actions:f,mutations:P,state:m};var O=D,y=n(86442),L=n(76897);r["default"].use(a.Ay);const g={setDisplayInfo(e,t){Object.assign(e.displayInfo,t)},setGlobal(e,t){Object.assign(e.global,t)},setErrorModal(e,t){Object.assign(e.errorModal,t)},setTimestamp(e,t){e.timestamp=t},setHeaderBackRootPage(e,t){e.headerRootPage&&!t.force||(e.headerRootPage=t.pageName)},setExternalId(e,t){e.externalId=t},setSystemAnnouncementBannerInfo(e,t){e.systemAnnouncementBannerInfo=t}},U={setDisplayInfo({commit:e},t){e("setDisplayInfo",t)},setGlobal({commit:e},t){e("setGlobal",t)},setErrorModal({commit:e},t){e("setErrorModal",t)},setTimestamp({commit:e}){return(0,o.A)((function*(){try{const{timestamp:t}=yield u.A.getServerTimestamp();e("setTimestamp",t)}catch(t){return!1}}))()},setStorageSignFlow({commit:e},t){t.scope=t.scope||"OPA";const n=(0,l._S)(E.A.KEY.SIGN_FLOW)||{};(0,l.AP)(E.A.KEY.SIGN_FLOW,Object.assign(n,t)),e("setGlobal",{scope:t.scope})},redirectAfterSignFlow(e,t){const{redirect:n}=this.getters.signInformation();t&&(0,l.sc)(t),n&&(window.location.href=n)},removeOPAStorage(e,t){t&&(0,l.sc)(t)},removeLocalstorage(e,t){t.forEach((e=>{(0,l.sc)(e)}))},setHeaderBackRootPage({commit:e},t){e("setHeaderBackRootPage",t)},isHeaderBackToNativeApp({state:e},t){return e.headerRootPage===t},prepareHelpLink({commit:e,state:t}){return(0,o.A)((function*(){if(t.externalId)return;const n=yield u.A.account.fetchUserInfo({});n&&e("setExternalId",n.external_id)}))()},getSystemAnnouncementBannerInfo({commit:e},t){return(0,o.A)((function*(){var n;const[,i]=yield u.A.bff.getSystemAnnouncementBannerInfo(t),o=null===i||void 0===i||null===(n=i.payload)||void 0===n?void 0:n.systemAnnouncementBannerInfo;e("setSystemAnnouncementBannerInfo",o)}))()}},v={getExternalId(e){return e.externalId},displayInfo(e){return e.displayInfo},isOpenApiScope(e){return"OPA"===e.global.scope},isYahooWalletScope(e){const t=E.A.VALUE.YAHOO_WALLET,n=(0,l._S)(E.A.KEY.YAHOO_CALLBACK);return e.global.scope===t||n&&n.scope===t},isYahooLinkScope(e){const t=E.A.VALUE.YAHOO_LINK,n=(0,l._S)(E.A.KEY.YAHOO_CALLBACK);return e.global.scope===t||n&&n.scope===t},isYahooLinkExpired(){const e=(0,l._S)(E.A.KEY.YAHOO_CALLBACK),t=!e||!e.validUntil||(new Date).getTime()>e.validUntil;return t},signInformation:e=>()=>{const t=(0,l._S)(E.A.KEY.SIGN_FLOW)||{},n=t.scope||e.global.scope;return{signUp:n===E.A.VALUE.SIGN_UP,signIn:n===E.A.VALUE.SIGN_IN,source:t.source,query:t.query,redirect:t.redirect,origin:t.origin}},getHelpLinkQuery(e){const{externalId:t}=e,n=(0,d.uo)();return c().stringify({external_id:t,platform:n.toLowerCase()})},getHeaderRootPage({headerRootPage:e}){return e},systemAnnouncementBannerInfo(e){return e.systemAnnouncementBannerInfo}},M={displayInfo:I.p.createDefault(),version:"1.0.0",global:{scope:""},timestamp:(new Date).getTime(),errorModal:{url:""},headerRootPage:"",otp:{type:"mobile",identification:"",otpPrefix:"",referenceId:""},externalId:"",systemAnnouncementBannerInfo:null},h={state:M,getters:v,actions:U,mutations:g,modules:{openApi:S.Nd,opaWeb:A.DZ,opaAmazon:p.P3,opaAliPay:_.Le,opaApple:T.x7,otp:C.o,accountLinkage:N.A,newStep:O,p2p:y.T,opaOauth2:L.s4}};var k=new a.Ay.Store(h)},67034:function(e,t,n){n.d(t,{m:function(){return i}});var i,o=n(5873),r=(n(44114),n(96470)),a=n(14516),s=n(27685);(function(e){e["INITIAL"]="INITIAL",e["READY"]="READY",e["NOT_SIGN_IN"]="NOT_SIGN_IN",e["SIGN_IN_SUCCESS"]="SIGN_IN_SUCCESS",e["AGREEMENT_AGREED"]="AGREEMENT_AGREED",e["LINKAGE_LINKING"]="LINKAGE_LINKING",e["LINKAGE_SUCCESS"]="LINKAGE_SUCCESS",e["LINKAGE_FAILURE"]="LINKAGE_FAILURE"})(i||(i={}));const c={serviceName:"_null",flowStatus:i.INITIAL,meta:{}},l=()=>{const e=Object.assign({},c),t=(new Date).getTime()+6e5;e._expireTime=t,(0,r.AP)(s.A.KEY.ACCOUNT_LINKAGE_FLOW,e)},d=()=>{(0,r.sc)(s.A.KEY.ACCOUNT_LINKAGE_FLOW)},u=()=>{const e=(0,r._S)(s.A.KEY.ACCOUNT_LINKAGE_FLOW);if(!e)return!1;const t=(new Date).getTime();return e._expireTime<t?(d(),!1):(delete e._expireTime,e)},E={setServiceName(e,t){e.serviceName=t},setFlowStatus(e,t){e.flowStatus=t},setMeta(e,t){e.meta=(0,o.A)((0,o.A)({},e.meta),t)},updateAccountLinkage(e,t){const{serviceName:n,flowStatus:i,meta:r}=t;e.serviceName=n,e.flowStatus=i,r&&(e.meta=(0,o.A)((0,o.A)({},e.meta),r))},loadFromLocalStorage(e,t){t&&(e.serviceName=t.serviceName,e.flowStatus=t.flowStatus,e.meta=(0,o.A)({},t.meta))}},I={isAccountLinkage:e=>{const t="_null"!==e.serviceName;return t&&e.flowStatus!==i.INITIAL}},S={setServiceName({commit:e},t){e("setServiceName",t),l()},setFlowStatus({commit:e},t){e("setFlowStatus",t),l()},setMeta({commit:e},t){e("setMeta",t),l()},updateAccountLinkage({commit:e},t){e("updateAccountLinkage",t),l()},restoreStateIfNeeded:({state:e,dispatch:t})=>{e.flowStatus===i.INITIAL&&t("loadFromLocalStorage")},loadFromLocalStorage({commit:e}){e("loadFromLocalStorage",u())},removeLocalStorage(){d()},redirectSigninSuccess({commit:e},t){const{flowStatus:n}=t;n&&(e("setFlowStatus",n),l()),(0,r.sc)(s.A.KEY.SIGN_FLOW),a.A.push({name:"accountLinkageCallback",params:{serviceName:c.serviceName}})}},A={namespaced:!0,state:c,getters:I,actions:S,mutations:E};t.A=A},48008:function(e,t,n){n.d(t,{pH:function(){return P},_t:function(){return T},te:function(){return C},fR:function(){return R},bk:function(){return m},Le:function(){return g}});var i=n(5873),o=n(75805),r=(n(89463),n(74423),n(62953),n(68997)),a=n(96470),s=n(80760),c=n(24909),l=n(25618),d=n(52901),u=n(67120),E=n(39789),I=n(14516),S=n(87365),A=n(6634);n(27495);const p=e=>{const t=e&&e.alipay_account_link_qr_data,n=e&&e.code;if(!e||!t||!n)return null;const i=n.match(/\/28180108(.+)/);return!i||i.length<2?null:{code:e.code,codeId:i[1],phoneNumber:"",merchant:{name:t.authClientName,logoUrl:t.authClientLogo,clientId:t.authClientId,permissions:t.scopes,redirectUrl:t.authRedirectUrl,termsCondition:{url:t.termsConditions.url,displayText:t.termsConditions.description},isKyc:!1,permissionTexts:t.permissions,legalText:t.legalText,customProperties:t.customProperties}}};class _{static createFromUserModule(e){var t;if(!e)return null;const i=e.mobile,o=e.user_defined_id;return{identification:i||o||"",displayName:e.display_name||"",photoUrl:null!==(t=e.photo_url)&&void 0!==t?t:n(20616),externalId:e.external_id}}}var T,C,N,R,m,P;(function(e){e["CODE_EXPIRED"]="CODE_EXPIRED",e["ACC_LINK"]="ACC_LINK",e["REDIRECT_SCREEN"]="REDIRECT_SCREEN",e["ERROR"]="ERROR",e["PROCESSING"]="PROCESSING",e["SIGN_IN"]="SIGN_IN",e["SIGN_IN_OTP"]="SIGN_IN_OTP",e["SIGN_UP"]="SIGN_UP",e["SIGN_UP_OTP"]="SIGN_UP_OTP",e["KYC_NOT_COMPLETED"]="KYC_NOT_COMPLETED",e["KYC_DATA_MISMATCH"]="KYC_DATA_MISMATCH",e["INTENT_CLICKED"]="INTENT_CLICKED",e["UNDEFINED"]="UNDEFINED",e["USER_CANCEL"]="USER_CANCEL",e["ALREADY_LINKED"]="ALREADY_LINKED"})(T||(T={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["UNDEFINED"]="UNDEFINED"}(C||(C={})),function(e){e["INITIAL"]="INITIAL",e["FETCHING"]="FETCHING",e["FETCHED"]="FETCHED",e["ERROR"]="ERROR",e["EXPIRED"]="EXPIRED"}(N||(N={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["OTP_REQUIRED"]="OTP_REQUIRED",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(R||(R={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["FAILED_NOT_MATCH"]="FAILED_NOT_MATCH",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(m||(m={})),function(e){e["GOOGLE"]="Google",e["MICROSOFT"]="Microsoft"}(P||(P={}));const f=()=>({displayInfo:l.p.createDefault(),mode:T.SIGN_IN,screenType:C.UNDEFINED,isPollingStarted:!1,isSignProcessing:!1,isModalProfileBoxVisible:!1,isProfileMenuButtonVisible:!0,accLinkInfo:null,accLinkInfoStatus:N.INITIAL,isRedirectScreenDisplayed:!1,isSignErrorTipDisplayed:!1,errorCode:"",userDisplayInfo:null,userDisplayInfoStatus:N.INITIAL,redirectTimer:0,redirectUrl:null,expiryTimer:0,isFetchingData:!1,client:{logo:"",name:"",clientId:"",phoneNumber:"",permissions:[],privacyPolicy:{url:"",displayText:""},termsConditions:{url:"",displayText:""},kycCheck:!1,accountLinkFooterText:"",permissionTexts:[],legalText:"",customProperties:{utmInformation:{utmSource:""},merchantConfigurations:{scanToLink:!1,hideSignUp:!0},gaEventData:{mId:""},headerDetailClientInfo:{headerDetailClientLogo:"",headerDetailClientName:""}}},errorMode:null,isAlipayOnline:!0});var D=n(89113);const O={setState({commit:e},t){e("setState",t)},getAccLinkInfoAsync({commit:e,dispatch:t,state:n},i){return(0,o.A)((function*(){var o;n.accLinkInfoStatus!==N.ERROR&&e("setState",{accLinkInfoStatus:N.FETCHING});const[,r]=yield c.A.paylite.getQrCodeFetch({code:i});let a=null,s=null;if(!r)return e("setState",{accLinkInfoStatus:N.ERROR}),!1;if(a=r.alipay_account_link_qr_data,s=p(r),!r||!a||!s)return e("setState",{accLinkInfoStatus:N.ERROR}),!1;const l=yield c.A.getServerTimestamp();if(!l)return e("setState",{accLinkInfoStatus:N.ERROR}),!1;const d=l.timestamp/1e3;let u=0;u=a.expiresAt;const E=d<u;e("setState",{accLinkInfo:s,accLinkInfoStatus:E?N.FETCHED:N.EXPIRED,redirectUrl:null===(o=a)||void 0===o?void 0:o.authRedirectUrl}),setTimeout((()=>t("alipayCheckLinkStatus")));const I=[T.CODE_EXPIRED,T.ERROR,T.REDIRECT_SCREEN,T.USER_CANCEL].includes(n.mode);let S=Math.floor(u-d);if(!I){const t=setInterval((()=>{S>0&&!I?(e("setState",{expiryTimer:S}),--S):(e("setState",{mode:T.CODE_EXPIRED,expiryTimer:0}),clearInterval(t))}),1e3)}return yield new Promise((e=>setTimeout(e,500))),E}))()},getUserInfoAsync({commit:e,rootGetters:t,rootState:n}){return(0,o.A)((function*(){e("setState",{isSignProcessing:!0,userDisplayInfoStatus:N.FETCHING});const i=_.createFromUserModule(yield c.A.account.fetchUserInfo({}));return i?(e("setState",{mode:T.ACC_LINK,isSignProcessing:!1,userDisplayInfo:i,userDisplayInfoStatus:N.FETCHED}),!0):(n.otp.referenceId?e("setState",{isSignProcessing:!1,mode:t.signInformation(n).signIn?T.SIGN_IN_OTP:T.SIGN_UP_OTP}):e("setState",{mode:T.SIGN_IN,isSignProcessing:!1}),!1)}))()},signOutAsync({commit:e,state:t}){return(0,o.A)((function*(){e("setState",{isSignProcessing:!0}),yield c.A.logout(),(0,a.sw)();const n=(0,i.A)((0,i.A)({},f()),{},{isSignProcessing:!0,mode:t.mode===T.REDIRECT_SCREEN?T.REDIRECT_SCREEN:T.SIGN_IN,screenType:t.screenType,accLinkInfo:t.accLinkInfo,accLinkInfoStatus:t.accLinkInfoStatus});setTimeout((()=>e("setState",n)),500),setTimeout((()=>e("setState",{isSignProcessing:!1})),1e3)}))()},signWithMobileAsync({commit:e,state:t},n){return(0,o.A)((function*(){if(t.isSignProcessing)return[R.ALREADY_PROCESSING];e("setState",{isSignProcessing:!0,isSignErrorTipDisplayed:!1});const[,o,r]=t.mode===T.SIGN_IN?yield c.A.userModule.oauthTokenPassword((0,i.A)((0,i.A)({},n),{},{login_type:D.$_.ALIPAY_ACCOUNT_LINKING})):yield c.A.userModule.signUpMobile({mobile:n.username,password:n.password}),a=Boolean(o&&o.otp_reference_id),s=Boolean(o&&o.access_token);switch(setTimeout((()=>e("setState",{isSignProcessing:!1})),250),!0){case a:return o&&o.otp_reference_id?[R.OTP_REQUIRED,o.otp_reference_id,o.otp_prefix]:[R.FAILED];case s:return[R.SUCCESS];default:switch(t.mode){case T.SIGN_IN:e("setState",{isSignErrorTipDisplayed:!0,errorCode:r&&r.response&&r.response.data&&r.response.data.result_info&&r.response.data.result_info.result_msg||""});break;case T.SIGN_UP:if((()=>{const e=o||r&&r.response&&r.response.data;return e&&e.result_info&&"01103104"===e.result_info.result_code_id})())e("setState",{isSignErrorTipDisplayed:!0});else{const t=l.p.createError("UM_GENERIC",o,r);e("setState",{displayInfo:t})}break}return[R.FAILED]}}))()},signVerifyOtpAsync({commit:e,state:t},n){return(0,o.A)((function*(){if(t.isSignProcessing)return m.ALREADY_PROCESSING;e("setState",{isSignProcessing:!0});const[i]=t.mode===T.SIGN_IN_OTP?yield c.A.userModule.oauthTokenOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:parseInt(n.otp,10),login_type:D.$_.ALIPAY_ACCOUNT_LINKING}):yield c.A.userModule.signUpMobileValidateOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:n.otp});return i||setTimeout((()=>e("setState",{isSignProcessing:!1})),250),i?m.SUCCESS:m.FAILED}))()},startRedirectTimer({commit:e}){let t=3;return e("setState",{redirectTimer:t}),new Promise((n=>{setTimeout((()=>{setInterval((()=>{t>=0?(e("setState",{redirectTimer:t}),t--):n(!0)}),1e3)}),1e3)}))},alipayCheckLinkStatus({getters:e,commit:t,dispatch:n}){return(0,o.A)((function*(){const i=e.codeId,r=setInterval((0,o.A)((function*(){try{const{data:{data:t}}=yield(0,d.oc)({codeId:i});t.alipayWebRedirectUrl&&!e.isRedirectScreenDisplayed&&(clearInterval(r),n("alipayDecisionResult",{redirectUrl:t.alipayWebRedirectUrl}))}catch(o){clearInterval(r),t("updateMode",T.ERROR)}})),2e3)}))()},startCheckingLinkStatus({commit:e,state:t}){return(0,o.A)((function*(){e("setState",{isPollingStarted:!0});const n=setInterval((0,o.A)((function*(){if(t.isPollingStarted&&-1===[T.ERROR,T.PROCESSING,T.KYC_DATA_MISMATCH,T.KYC_NOT_COMPLETED,T.INTENT_CLICKED].indexOf(t.mode)){const i=yield c.A.openApi.checkAccountLinkStatus();if(!i||i===A.OQ.SESSION_NOT_FOUND)return clearInterval(n),void e("setState",{isPollingStarted:!1,mode:T.CODE_EXPIRED});const{data:o}=i;if(o&&("ACCEPTED"===o.accountLinkStatus||"DECLINED"===o.accountLinkStatus)){let i=o.callbackUrl;i+=i.indexOf("?")>-1?"&":"?",o.callbackParams&&(i+=r.A.stringify(o.callbackParams)),"ACCEPTED"===o.accountLinkStatus?e("setState",{mode:T.REDIRECT_SCREEN,redirectUrl:i}):(clearInterval(n),t.isPollingStarted=!1,window.location.href=i),clearInterval(n),t.isPollingStarted=!1}}})),2e3)}))()},alipayMakeDecision({commit:e,dispatch:t,getters:n},{decision:i,isAppFlow:r=!1}){return(0,o.A)((function*(){try{r||(yield(0,d.I$)({codeId:n.codeId}));const{data:e}=yield(0,d.UO)({codeId:n.codeId,decision:i}),{alipayWebRedirectUrl:o}=e.data;t("alipayDecisionResult",{redirectUrl:o})}catch(o){e("updateMode",T.ERROR)}}))()},alipayDecisionResult({commit:e},{redirectUrl:t}){var n,i;if(!t)return void e("updateMode",T.ERROR);const o=null===(n=r.A.parse(t))||void 0===n||null===(i=n.resultCode)||void 0===i?void 0:i.split("#")[0];switch(o){case"SUCCESS":e("updateRedirectUrl",t),e("updateMode",T.REDIRECT_SCREEN);break;case"USER_CANCEL":e("updateRedirectUrl",t),e("updateMode",T.USER_CANCEL);break;default:e("updateMode",T.ERROR)}},alipayDecisionResultNative({commit:e},{redirectUrl:t}){var n,i;if(!t)return void e("updateMode",T.ERROR);const o=null===(n=r.A.parse(t))||void 0===n||null===(i=n.resultCode)||void 0===i?void 0:i.split("#")[0];switch(o){case"SUCCESS":case"USER_CANCEL":e("updateRedirectUrl",t);break;default:e("updateMode",T.ERROR)}},alipayMakeDecisionNative({dispatch:e},{decision:t}){return(0,o.A)((function*(){var n;const o=I.A.currentRoute.query.codeId||"",r=I.A.currentRoute.query.referenceAgreementId||"",a=!(0,s.kp)({ios:S.wq,android:S._M}),c=(null===(n=I.A.currentRoute.query)||void 0===n?void 0:n.mode)||"";try{const{data:n}=yield(0,d.UO)({codeId:o,decision:t}),{data:s,resultInfo:u}=n,E=u.code,A=()=>{const e=(0,i.A)((0,i.A)({referenceAgreementId:r,resultInfo:u},s),{},{authRedirectUrl:s.alipayWebRedirectUrl});window.PayPayJsBridge.getAlipayAuthResult(e)};if(a&&"scan"!==c)return A(),!0;if(!a){var l;const t=(null===(l=I.A.currentRoute.query)||void 0===l?void 0:l.flow)||"";if(t===S.nl.APP_TO_APP)return A(),!0;if(t===S.nl.MOBILE_WEB||t===S.nl.MERCHANT_TERMINAL){const t=s.alipayWebRedirectUrl;return yield e("alipayDecisionResultNative",{redirectUrl:t}),!0}}if("SUCCESS"===E)return!0}catch(u){return!1}return!1}))()},alipayUpdateClientAsync({commit:e,state:t}){return(0,o.A)((function*(){const n=I.A.currentRoute.query.codeId||"";try{const{data:{resultInfo:i,data:o}}=yield(0,d.I$)({codeId:n});if("SUCCESS"===i.code){const n=yield c.A.getServerTimestamp();if(!n)return!1;const i=n.timestamp/1e3;let r=0;r=o.expiresAt;const a=i<r;e("setState",{accLinkInfoStatus:a?N.FETCHED:N.EXPIRED,redirectUrl:null===o||void 0===o?void 0:o.authRedirectUrl});const s=[T.CODE_EXPIRED,T.ERROR,T.REDIRECT_SCREEN,T.USER_CANCEL].includes(t.mode);let l=Math.floor(r-i);if(!s){const t=setInterval((()=>{l>0&&!s?(e("setState",{expiryTimer:l}),--l):(e("setState",{mode:T.CODE_EXPIRED,expiryTimer:0}),clearInterval(t))}),1e3)}return e("updateClient",{logo:o.authClientLogo,name:o.authClientName,clientId:o.authClientId,phoneNumber:"",permissions:o.scopes,termsConditions:{url:o.termsConditions.url,displayText:o.termsConditions.description},permissionTexts:o.permissions,legalText:o.legalText,customProperties:o.customProperties}),!0}}catch(i){}return!1}))()},updateClient({commit:e},t){e("updateClient",t)},googlePayUpdateClientAsync({commit:e,state:t}){return(0,o.A)((function*(){try{const{data:{resultInfo:o,data:r}}=yield(0,u.tG)();if("SUCCESS"===o.code){var n,i;if("USER_ALREADY_LINKED"===r.status)return e("updateMode",T.ALREADY_LINKED),!1;const o=yield c.A.getServerTimestamp();if(!o)return!1;const a=o.timestamp/1e3;let s=0;s=r.expiresAt;const l=a<s;e("setState",{accLinkInfoStatus:l?N.FETCHED:N.EXPIRED,redirectUrl:null===r||void 0===r?void 0:r.authRedirectUrl});const d=[T.CODE_EXPIRED,T.ERROR,T.REDIRECT_SCREEN,T.USER_CANCEL].includes(t.mode);let u=Math.floor(s-a);if(!d){const t=setInterval((()=>{u>0?(e("setState",{expiryTimer:u}),--u):(e("setState",{mode:T.CODE_EXPIRED,expiryTimer:0}),clearInterval(t))}),1e3)}return e("updateClient",{logo:null===r||void 0===r?void 0:r.authClientLogo,name:null===r||void 0===r?void 0:r.authClientName,clientId:null===r||void 0===r?void 0:r.authClientId,phoneNumber:"",permissions:null===r||void 0===r?void 0:r.scopes,termsConditions:{url:null===r||void 0===r||null===(n=r.termsConditions)||void 0===n?void 0:n.url,displayText:null===r||void 0===r||null===(i=r.termsConditions)||void 0===i?void 0:i.description},permissionTexts:null===r||void 0===r?void 0:r.permissions,legalText:null===r||void 0===r?void 0:r.legalText,customProperties:null===r||void 0===r?void 0:r.customProperties,sessionId:null===r||void 0===r?void 0:r.sessionId}),!0}e("updateMode",T.ERROR)}catch(E){var o,r,a,s,l,d;if("USER_ALREADY_LINKED"===(null===E||void 0===E||null===(o=E.response)||void 0===o||null===(r=o.data)||void 0===r||null===(a=r.resultInfo)||void 0===a?void 0:a.code))e("updateMode",T.ALREADY_LINKED),e("updateClient",{sessionId:null===E||void 0===E||null===(s=E.response)||void 0===s||null===(l=s.data)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.sessionId});else e("updateMode",T.ERROR)}return!1}))()},googlePayMakeDecision({commit:e,state:t},{decision:n}){return(0,o.A)((function*(){try{const i=t.client.sessionId||"",{data:o}=yield(0,u.og)({sessionId:i,decision:n}),{data:r,resultInfo:a}=o;return"SUCCESS"!==a.code?(e("updateMode",T.ERROR),!1):("ACCEPTED"===r.status?e("updateMode",T.REDIRECT_SCREEN):e("updateMode",T.USER_CANCEL),!0)}catch(i){e("updateMode",T.ERROR)}return!1}))()},googlePayAuthenticateUser({commit:e,state:t},{authRequest:n,appVersion:i}){return(0,o.A)((function*(){try{const o=t.client.sessionId||"",{data:r}=yield(0,u.ko)({sessionId:o,authRequest:n},i),{data:a,resultInfo:s}=r;return"SUCCESS"===s.code?a:(e("updateMode",T.ERROR),!1)}catch(o){e("updateMode",T.ERROR)}return!1}))()},getAccessTokenFromOtt({commit:e},{ott:t,clientId:n}){return(0,o.A)((function*(){try{const[i]=yield(0,E.D5)(t,n);return!!i||(e("updateMode",T.ERROR),!1)}catch(i){e("updateMode",T.ERROR)}return!1}))()},googlePayComplete({commit:e,state:t},{authRedirectUrl:n,accountLinkingResult:i,errors:r}){return(0,o.A)((function*(){try{const o=t.client.sessionId||"";if(""===o)return!1;const{data:a}=yield(0,u.ZR)({sessionId:o,authRedirectUrl:n,accountLinkingResult:i,errors:r}),{resultInfo:s}=a;return"SUCCESS"===s.code||(e("updateMode",T.ERROR),!1)}catch(o){e("updateMode",T.ERROR)}return!1}))()}},y={mode:({mode:e})=>e,screenType:({screenType:e})=>e,isPollingStarted:({isPollingStarted:e})=>e,isSignProcessing:({isSignProcessing:e})=>e,isFetchingData:({isFetchingData:e})=>e,isProcessingDisplayed:({mode:e})=>e===T.PROCESSING,accLinkInfo:({accLinkInfo:e})=>e,accLinkInfoStatus:({accLinkInfoStatus:e})=>e,merchantInfo:({accLinkInfo:e})=>e?e.merchant:{},isFetchingErrorQrCodeDisplayed:({accLinkInfoStatus:e,mode:t})=>[N.ERROR,N.EXPIRED].includes(e)||[T.ERROR,T.KYC_DATA_MISMATCH,T.KYC_NOT_COMPLETED].includes(t),isRedirectScreenDisplayed:({mode:e,accLinkInfoStatus:t})=>[T.REDIRECT_SCREEN,T.USER_CANCEL].includes(e)&&![N.ERROR,N.EXPIRED].includes(t),codeId:({accLinkInfo:e})=>e&&e.codeId||"",userDisplayInfo:({userDisplayInfo:e})=>e,userDisplayInfoStatus:({userDisplayInfoStatus:e})=>e,displayInfo:({displayInfo:e})=>e,isModalProfileBoxVisible:({isModalProfileBoxVisible:e})=>e,isProfileMenuButtonVisible:({isProfileMenuButtonVisible:e})=>e,isLoadingScreenVisible:({isSignProcessing:e})=>Boolean(e),isScreenModeDesktop:({screenType:e})=>e===C.DESKTOP,isScreenModeMobile:({screenType:e})=>e===C.MOBILE,isSignErrorTipDisplayed:({isSignErrorTipDisplayed:e})=>e,isSignInUpDisplayed:({mode:e})=>Boolean(e===T.SIGN_IN||e===T.SIGN_UP),isSignOtpDisplayed:({mode:e})=>Boolean(e===T.SIGN_IN_OTP||e===T.SIGN_UP_OTP),isAccountLinkDisplayed:({mode:e})=>Boolean(e===T.ACC_LINK),isScreenBlur:({displayInfo:e})=>Boolean(e.isVisible),redirectTimer:({redirectTimer:e})=>e,redirectUrl:({redirectUrl:e})=>e||"",expiryTimer:({expiryTimer:e})=>e,merchantId:({client:e})=>{var t,n;return(null===e||void 0===e||null===(t=e.customProperties)||void 0===t||null===(n=t.gaEventData)||void 0===n?void 0:n.mId)||""},isTimeout:({mode:e})=>e===T.CODE_EXPIRED,headerLogo:({accLinkInfo:e})=>{var t,n,i;return(null===e||void 0===e||null===(t=e.merchant)||void 0===t||null===(n=t.customProperties)||void 0===n||null===(i=n.headerDetailClientInfo)||void 0===i?void 0:i.headerDetailClientLogo)||""},headerTitle:({accLinkInfo:e})=>{var t,n,i;return(null===e||void 0===e||null===(t=e.merchant)||void 0===t||null===(n=t.customProperties)||void 0===n||null===(i=n.headerDetailClientInfo)||void 0===i?void 0:i.headerDetailClientName)||""}},L={setState(e,t){Object.assign(e,t)},updateRedirectUrl(e,t){e.redirectUrl=t},updateMode(e,t){e.mode=t},updateExpiryTimer(e,t){e.expiryTimer=t},updateClient(e,t){e.client=t}},g={namespaced:!0,actions:O,getters:y,mutations:L,state:f()}},72455:function(e,t,n){n.d(t,{Or:function(){return E.Or},Fn:function(){return E.Fn},Yh:function(){return E.Yh},te:function(){return E.te},fR:function(){return E.fR},bk:function(){return E.bk},P3:function(){return m}});var i=n(5873),o=n(75805),r=(n(74423),n(62953),n(96470)),a=n(2619),s=n(24909),c=n(25618),l=n(76951),d=n(21309),u=n(37253),E=n(24019);const I=()=>({displayInfo:c.p.createDefault(),accLinkInfoStatus:E.Fn.INITIAL,lastError:E.Yh.NO_ERROR,mode:E.Or.SIGN_IN,redirectTimerHandle:0,permissions:["direct_debit","pending_payments","get_balance"],phoneNumber:"",sessionId:"",screenType:E.te.UNDEFINED,isPollingStarted:!1,isSignProcessing:!1,isModalProfileBoxVisible:!1,isProfileMenuButtonVisible:!0,accLinkInfo:null,isRedirectScreenDisplayed:!1,isSignErrorTipDisplayed:!1,errorCode:"",userDisplayInfo:null,userDisplayInfoStatus:E.Fn.INITIAL,redirectTimer:0,redirectUrl:"",expiryTimer:0,isFetchingData:!1,currentTimestamp:null,expiryTimestamp:null,systemAnnouncementBannerInfo:null});n(27495);const S=e=>{const t=e&&e.amazon_account_link_qr_data,n=e&&e.code;if(!e||!t||!n)return null;const i=n.match(/\/28180109(.+)/);return!i||i.length<2?null:{code:e.code,codeId:i[1],phoneNumber:"",merchant:{name:t.clientName,logoUrl:t.clientLogo,permissions:[],redirectUrl:t.callbackUrl,termsCondition:{url:"",displayText:""},isKyc:!1}}};class A{static createFromUserModule(e){if(!e)return null;const t=e.mobile?e.mobile.substring(0,3)+"******"+e.mobile.substring(e.mobile.length-2):"",i=e.user_defined_id;return{id:e?e.id:-1,externalId:e.external_id,identification:t||i||"",displayName:e.display_name||"",photoUrl:e.photo_url||n(25848)}}}let p;const _=(e,t)=>{p&&clearInterval(p);const n={isPollingStarted:!1};t&&(n.mode=t),e("setState",n)},T=(e,t)=>{"SUCCESS"===t.status.toUpperCase()?(e("setState",{redirectUrl:t.callbackURL}),_(e,E.Or.REDIRECT_SCREEN)):"DECLINED"===t.status.toUpperCase()&&(e("setState",{redirectUrl:t.callbackURL}),_(e),window.location.href=t.callbackURL)},C={setState({commit:e},t){e("setState",t)},getAccLinkInfoAsync({commit:e,state:t,dispatch:n},i){return(0,o.A)((function*(){var o;t.accLinkInfoStatus!==E.Fn.ERROR&&e("setState",{accLinkInfoStatus:E.Fn.FETCHING});const[,r]=yield s.A.paylite.getQrCodeFetch({code:i});let a=null,c=null;if(!r)return e("setState",{accLinkInfoStatus:E.Fn.ERROR}),!1;if(a=r.amazon_account_link_qr_data,c=S(r),!r||!a||!c)return e("setState",{accLinkInfoStatus:E.Fn.ERROR}),!1;const l=yield s.A.getServerTimestamp();if(!l)return e("setState",{accLinkInfoStatus:E.Fn.ERROR}),!1;const d=l.timestamp/1e3;let u=0;u=a.expiresAt,e("setState",{currentTimestamp:+d,expiryTimestamp:+u});const I=d<u;if(e("setState",{accLinkInfo:c,accLinkInfoStatus:I?E.Fn.FETCHED:E.Fn.EXPIRED,redirectUrl:null===(o=a)||void 0===o?void 0:o.callbackUrl}),t.screenType===E.te.DESKTOP){setTimeout((()=>n("startCheckingLinkStatus")));const i=[E.Or.CODE_EXPIRED,E.Or.ERROR,E.Or.REDIRECT_SCREEN].includes(t.mode);if(!i){let t=Math.floor(u-d);if(!i){const n=setInterval((()=>{t>0&&!i?(e("setState",{expiryTimer:t}),--t):(e("setState",{mode:E.Or.CODE_EXPIRED}),clearInterval(n))}),1e3)}}}return yield new Promise((e=>setTimeout(e,500))),I}))()},signVerifyOtpAsync({commit:e,state:t},n){return(0,o.A)((function*(){if(t.isSignProcessing)return E.bk.ALREADY_PROCESSING;e("setState",{isSignProcessing:!0});const[i]=t.mode===E.Or.SIGN_IN_OTP?yield s.A.userModule.oauthTokenOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:parseInt(n.otp,10)}):yield s.A.userModule.signUpMobileValidateOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:n.otp});return i||setTimeout((()=>e("setState",{isSignProcessing:!1})),250),i?E.bk.SUCCESS:E.bk.FAILED}))()},signWithMobileAsync({commit:e,state:t},n){return(0,o.A)((function*(){if(t.isSignProcessing)return[E.fR.ALREADY_PROCESSING];e("setState",{isSignProcessing:!0,isSignErrorTipDisplayed:!1});const[,i,o]=t.mode===E.Or.SIGN_IN?yield s.A.userModule.oauthTokenPassword(n):yield s.A.userModule.signUpMobile({mobile:n.username,password:n.password}),r=Boolean(i&&i.otp_reference_id),a=Boolean(i&&i.access_token);switch(setTimeout((()=>e("setState",{isSignProcessing:!1})),250),!0){case r:return i&&i.otp_reference_id?[E.fR.OTP_REQUIRED,i.otp_reference_id,i.otp_prefix]:[E.fR.FAILED];case a:return[E.fR.SUCCESS];default:switch(t.mode){case E.Or.SIGN_IN:e("setState",{isSignErrorTipDisplayed:!0,errorCode:o&&o.response&&o.response.data&&o.response.data.result_info&&o.response.data.result_info.result_msg||""});break;case E.Or.SIGN_UP:if((()=>{const e=i||o&&o.response&&o.response.data;return e&&e.result_info&&"01103104"===e.result_info.result_code_id})())e("setState",{isSignErrorTipDisplayed:!0});else{const t=c.p.createError("UM_GENERIC",i,o);e("setState",{displayInfo:t})}break}return[E.fR.FAILED]}}))()},getViewInfoOfAmazonAccountLinking({commit:e,dispatch:t,state:n},i){return(0,o.A)((function*(){var o,r,s,c,u,I;const S=i;try{const{data:{resultInfo:n,data:i}}=yield(0,a.kf)({codeId:S});if(n.code===E.Yh.SUCCESS)return e("setState",{lastError:n.code,phoneNumber:i.phoneNumber,permissions:i.permissions}),yield t("resetExpireTimer",i.expiresAt),!0}catch(A){const{data:t}=A.response;switch(e("setState",{lastError:t.resultInfo.code||"",redirectUrl:t.data.redirectUrl||"",phoneNumber:t.data.phoneNumber||""}),t.resultInfo.code){case E.Yh.EXPIRED_ACCOUNT_LINK_SESSION:case E.Yh.TIMEOUT:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.TIMEOUT_ERR,external_id:null===n||void 0===n||null===(o=n.userDisplayInfo)||void 0===o?void 0:o.externalId});break;case E.Yh.NON_KYC_USER:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.KYC_ERR,external_id:null===n||void 0===n||null===(r=n.userDisplayInfo)||void 0===r?void 0:r.externalId});break;case E.Yh.AMAZON_ID_ALREADY_LINKED:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.AMZ_ACCOUNT_LINKED_ERR,external_id:null===n||void 0===n||null===(s=n.userDisplayInfo)||void 0===s?void 0:s.externalId});break;case E.Yh.USER_ALREADY_LINKED:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.PP_ACCOUNT_LINKED_ERR,external_id:null===n||void 0===n||null===(c=n.userDisplayInfo)||void 0===c?void 0:c.externalId});break;case E.Yh.RISK_CHECK_FAIL:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.RISK_ERR,external_id:null===n||void 0===n||null===(u=n.userDisplayInfo)||void 0===u?void 0:u.externalId});break;default:(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.GENERAL_ERROR,external_id:null===n||void 0===n||null===(I=n.userDisplayInfo)||void 0===I?void 0:I.externalId})}return _(e),!1}return!1}))()},getUserInfoAsync({commit:e,rootGetters:t,rootState:n}){return(0,o.A)((function*(){e("setState",{isSignProcessing:!0,userDisplayInfoStatus:E.Fn.FETCHING});const i=A.createFromUserModule(yield s.A.account.fetchUserInfo({}));return i?(e("setState",{mode:E.Or.ACC_LINK,isSignProcessing:!1,userDisplayInfo:i,userDisplayInfoStatus:E.Fn.FETCHED}),(0,l.h)("view",{event_category:d.ms.AMAZON_ACC_LINK,screen_name:d.j0.PERMISSION_SCREEN,external_id:i.externalId}),!0):(n.otp.referenceId?e("setState",{isSignProcessing:!1,mode:t.signInformation(n).signIn?E.Or.SIGN_IN_OTP:E.Or.SIGN_UP_OTP}):e("setState",{mode:E.Or.SIGN_IN,isSignProcessing:!1}),!1)}))()},amazonMakeDecision({dispatch:e,commit:t,state:n},{decision:i,sessionId:r}){return(0,o.A)((function*(){try{const t=(0,u.Z)(),o=t?"wifi"===t:null,{data:s}=yield(0,a.Yc)({codeId:r,decision:i,wifiConnected:o});if("SUCCESS"===s.resultInfo.code){const{redirectUrl:t}=s.data,i={redirectUrl:t,lastError:s.resultInfo.code};return n.screenType===E.te.DESKTOP&&(i.mode=E.Or.REDIRECT_SCREEN),e("setState",i),!0}}catch(o){const{data:e}=o.response;return t("setState",{lastError:E.Yh.USER_DECLINED,redirectUrl:e.data.redirectUrl||""}),!1}return!1}))()},resetExpireTimer({commit:e},t){return(0,o.A)((function*(){let n;const i=yield s.A.getServerTimestamp();return n=i?Math.floor(i.timestamp/1e3):Math.floor(Date.now()/1e3),e("updateExpiryTimer",t-n),!0}))()},startRedirectTimer({commit:e}){let t=3;return e("setState",{redirectTimer:t}),new Promise((n=>{setTimeout((()=>{setInterval((()=>{t>=0?(e("setState",{redirectTimer:t}),t--):n(!0)}),1e3)}),1e3)}))},signOutAsync({commit:e,state:t}){return(0,o.A)((function*(){e("setState",{isSignProcessing:!0}),yield s.A.logout(),(0,r.sw)();const n=(0,i.A)((0,i.A)({},I()),{},{isSignProcessing:!0,mode:t.mode===E.Or.REDIRECT_SCREEN?E.Or.REDIRECT_SCREEN:E.Or.SIGN_IN,screenType:t.screenType,accLinkInfo:t.accLinkInfo,accLinkInfoStatus:t.accLinkInfoStatus});setTimeout((()=>e("setState",n)),500),setTimeout((()=>e("setState",{isSignProcessing:!1})),1e3)}))()},startCheckingLinkStatus({commit:e,state:t}){return(0,o.A)((function*(){e("setState",{isPollingStarted:!0}),p=window.setInterval((0,o.A)((function*(){if(t.isPollingStarted&&-1===[E.Or.PROCESSING,E.Or.KYC_DATA_MISMATCH,E.Or.KYC_NOT_COMPLETED,E.Or.INTENT_CLICKED].indexOf(t.mode)){var n,i,o;let t;try{t=yield(0,a.cx)()}catch(r){_(e,E.Or.CODE_EXPIRED)}if(!t||"SUCCESS"!==(null===(n=t)||void 0===n||null===(i=n.data)||void 0===i||null===(o=i.resultInfo)||void 0===o?void 0:o.code))return void _(e,E.Or.CODE_EXPIRED);const{data:s}=t.data;s&&T(e,s)}})),2e3)}))()},getSystemAnnouncementBannerInfo({commit:e},t){return(0,o.A)((function*(){let n="";switch(t.screenType){case"SIGN_IN":n="SIGNIN";break;case"SIGN_UP":n="SIGNUP";break}if(n)try{const[t,i]=yield s.A.bff.getSystemAnnouncementBannerInfo(n);t&&e("setState",{systemAnnouncementBannerInfo:null===i||void 0===i?void 0:i.payload.systemAnnouncementBannerInfo})}catch(i){}}))()}},N={permissions:({permissions:e})=>e,lastError:({lastError:e})=>e,redirectUrl:({redirectUrl:e})=>e,redirectTimerHandle:({redirectTimerHandle:e})=>e,phoneNumber:({phoneNumber:e})=>e,sessionId:({sessionId:e})=>e,isScreenModeDesktop:({screenType:e})=>e===E.te.DESKTOP,isScreenModeMobile:({screenType:e})=>e===E.te.MOBILE,isSignInUpDisplayed:({mode:e})=>Boolean(e===E.Or.SIGN_IN||e===E.Or.SIGN_UP),isSignErrorTipDisplayed:({isSignErrorTipDisplayed:e})=>e,isSignOtpDisplayed:({mode:e})=>Boolean(e===E.Or.SIGN_IN_OTP||e===E.Or.SIGN_UP_OTP),isAccountLinkDisplayed:({mode:e})=>Boolean(e===E.Or.ACC_LINK),isRedirectScreenDisplayed:({mode:e,accLinkInfoStatus:t})=>[E.Or.REDIRECT_SCREEN].includes(e)&&![E.Fn.ERROR,E.Fn.EXPIRED].includes(t),isProcessingDisplayed:({mode:e})=>e===E.Or.PROCESSING,isFetchingErrorQrCodeDisplayed:({accLinkInfoStatus:e,mode:t})=>[E.Fn.ERROR,E.Fn.EXPIRED].includes(e)||[E.Or.ERROR,E.Or.KYC_DATA_MISMATCH,E.Or.KYC_NOT_COMPLETED,E.Or.AMAZON_ID_ALREADY_LINKED,E.Or.USER_ALREADY_LINKED].includes(t),isTimeout:({mode:e})=>e===E.Or.CODE_EXPIRED,phoneNumberWithMaskingAndSeparators({phoneNumber:e}){const t="XXX******XX",n=(e.match(/\d+/g)||[""]).join("");let i="";for(let o=0;o<=n.length;o++)3!==o&&7!==o||(i+="-"),"X"!=t.charAt(o)?i+=t.charAt(o):i+=e.charAt(o);return i},mode:({mode:e})=>e,screenType:({screenType:e})=>e,isPollingStarted:({isPollingStarted:e})=>e,isSignProcessing:({isSignProcessing:e})=>e,isFetchingData:({isFetchingData:e})=>e,accLinkInfo:({accLinkInfo:e})=>e,accLinkInfoStatus:({accLinkInfoStatus:e})=>e,merchantInfo:({accLinkInfo:e})=>e?e.merchant:{},codeId:({accLinkInfo:e})=>e&&e.codeId||"",userDisplayInfo:({userDisplayInfo:e})=>e,userDisplayInfoStatus:({userDisplayInfoStatus:e})=>e,displayInfo:({displayInfo:e})=>e,isModalProfileBoxVisible:({isModalProfileBoxVisible:e})=>e,isProfileMenuButtonVisible:({isProfileMenuButtonVisible:e})=>e,isLoadingScreenVisible:({isSignProcessing:e})=>Boolean(e),isScreenBlur:({displayInfo:e})=>Boolean(e.isVisible),redirectTimer:({redirectTimer:e})=>e,expiryTimer:({expiryTimer:e})=>e,systemAnnouncementBannerInfo:({systemAnnouncementBannerInfo:e})=>e},R={setState(e,t){Object.assign(e,t)},updateRedirectUrl(e,t){e.redirectUrl=t},updateExpiryTimer(e,t){e.expiryTimer=t}},m={namespaced:!0,actions:C,getters:N,mutations:R,state:I()}},24019:function(e,t,n){var i,o,r,a,s,c;n.d(t,{Fn:function(){return o},Or:function(){return i},Yh:function(){return a},bk:function(){return c},fR:function(){return s},te:function(){return r}}),function(e){e["CODE_EXPIRED"]="CODE_EXPIRED",e["ACC_LINK"]="ACC_LINK",e["REDIRECT_SCREEN"]="REDIRECT_SCREEN",e["ERROR"]="ERROR",e["PROCESSING"]="PROCESSING",e["SIGN_IN"]="SIGN_IN",e["SIGN_IN_OTP"]="SIGN_IN_OTP",e["SIGN_UP"]="SIGN_UP",e["SIGN_UP_OTP"]="SIGN_UP_OTP",e["KYC_NOT_COMPLETED"]="KYC_NOT_COMPLETED",e["KYC_DATA_MISMATCH"]="KYC_DATA_MISMATCH",e["INTENT_CLICKED"]="INTENT_CLICKED",e["UNDEFINED"]="UNDEFINED",e["AMAZON_ID_ALREADY_LINKED"]="AMAZON_ID_ALREADY_LINKED",e["USER_ALREADY_LINKED"]="USER_ALREADY_LINKED"}(i||(i={})),function(e){e["INITIAL"]="INITIAL",e["FETCHING"]="FETCHING",e["FETCHED"]="FETCHED",e["ERROR"]="ERROR",e["EXPIRED"]="EXPIRED"}(o||(o={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["APP"]="APP",e["UNDEFINED"]="UNDEFINED"}(r||(r={})),function(e){e["NO_ERROR"]="NO_ERROR",e["SUCCESS"]="SUCCESS",e["TIMEOUT"]="TIMEOUT",e["AUTHORIZATION_SESSION_NOT_FOUND"]="AUTHORIZATION_SESSION_NOT_FOUND",e["EXPIRED_ACCOUNT_LINK_SESSION"]="EXPIRED_ACCOUNT_LINK_SESSION",e["NON_KYC_USER"]="NON_KYC_USER",e["USER_ALREADY_LINKED"]="USER_ALREADY_LINKED",e["AMAZON_ID_ALREADY_LINKED"]="AMAZON_ID_ALREADY_LINKED",e["INTERNAL_SERVER_ERROR"]="INTERNAL_SERVER_ERROR",e["RISK_CHECK_FAIL"]="RISK_CHECK_FAIL",e["USER_DECLINED"]="USER_DECLINED",e["AUTHORIZATION_SESSION_UNEXPECTED_STATUS"]="AUTHORIZATION_SESSION_UNEXPECTED_STATUS"}(a||(a={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["OTP_REQUIRED"]="OTP_REQUIRED",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(s||(s={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["FAILED_NOT_MATCH"]="FAILED_NOT_MATCH",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(c||(c={}))},89504:function(e,t,n){n.d(t,{Ci:function(){return i},Yh:function(){return a},te:function(){return r},fR:function(){return c},bk:function(){return l},x7:function(){return v}});var i,o,r,a,s,c,l,d=n(5873),u=n(75805),E=(n(74423),n(62953),n(96470)),I=n(80760),S=n(95871),A=n(24909),p=n(25618),_=n(97857);(function(e){e["CODE_EXPIRED"]="CODE_EXPIRED",e["ACC_LINK"]="ACC_LINK",e["ACC_BIND"]="ACC_BIND",e["REDIRECT_SCREEN"]="REDIRECT_SCREEN",e["PROCESSING"]="PROCESSING",e["SIGN_IN"]="SIGN_IN",e["SIGN_IN_OTP"]="SIGN_IN_OTP",e["SIGN_UP"]="SIGN_UP",e["SIGN_UP_OTP"]="SIGN_UP_OTP",e["UNDEFINED"]="UNDEFINED",e["UNAUTHORIZED"]="UNAUTHORIZED",e["AUTHORIZATION_SESSION_UNEXPECTED_STATUS"]="AUTHORIZATION_SESSION_UNEXPECTED_STATUS",e["AUTHORIZATION_SESSION_EXPIRED"]="AUTHORIZATION_SESSION_EXPIRED"})(i||(i={})),function(e){e["INITIAL"]="INITIAL",e["FETCHING"]="FETCHING",e["FETCHED"]="FETCHED",e["ERROR"]="ERROR",e["EXPIRED"]="EXPIRED"}(o||(o={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["UNDEFINED"]="UNDEFINED",e["APP"]="APP"}(r||(r={})),function(e){e["NO_ERROR"]="NO_ERROR",e["SUCCESS"]="SUCCESS",e["TIMEOUT"]="TIMEOUT",e["AUTHORIZATION_SESSION_NOT_FOUND"]="AUTHORIZATION_SESSION_NOT_FOUND",e["AUTHORIZATION_SESSION_UNEXPECTED_STATUS"]="AUTHORIZATION_SESSION_UNEXPECTED_STATUS",e["AUTHORIZATION_SESSION_EXPIRED"]="AUTHORIZATION_SESSION_EXPIRED",e["UNKNOWN_ERROR"]="UNKNOWN_ERROR"}(a||(a={})),function(e){e["SUCCESS"]="SUCCESS",e["ERROR"]="ERROR",e["REDIRECTED"]="REDIRECTED",e["IDLE"]="IDLE"}(s||(s={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["OTP_REQUIRED"]="OTP_REQUIRED",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(c||(c={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["FAILED_NOT_MATCH"]="FAILED_NOT_MATCH",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(l||(l={}));n(27495);const T=e=>{const t=e&&e.apple_account_link_qr_data,n=e&&e.code;if(!e||!t||!n)return null;const i=n.match(/\/28180112(.+)/);return!i||i.length<2?null:{code:e.code,codeId:i[1],phoneNumber:"",merchant:{clientName:t.clientName,clientLogo:t.clientLogo}}};class C{static createFromUserModule(e){return e?{identification:e.user_defined_id||"",displayName:e.display_name||"",photoUrl:e.photo_url||n(27362)}:null}}var N=n(65092);const R=()=>({displayInfo:p.p.createDefault(),accLinkInfoStatus:o.INITIAL,lastError:a.NO_ERROR,mode:i.SIGN_IN,redirectTimerHandle:0,permissions:[],maskedPhoneNumber:"",sessionId:"",screenType:r.UNDEFINED,decision:N.PS.Accepted,isScanMode:!1,isBindingProcessing:!1,isProfileMenuButtonVisible:!0,isPollingStarted:!1,isSignProcessing:!1,isModalProfileBoxVisible:!1,accLinkInfo:null,isRedirectScreenDisplayed:!1,isSignErrorTipDisplayed:!1,errorCode:"",userDisplayInfo:null,userDisplayInfoStatus:o.INITIAL,userId:0,redirectTimer:0,redirectUrl:"",expiryTimer:0,isFetchingData:!1,clientLogo:"",clientName:""});let m;const P=(e,t)=>{m&&clearInterval(m);const n={isPollingStarted:!1};t&&(n.mode=t),e("setState",n)},f=(e,t)=>{"ACCEPTED"===t.status.toUpperCase()?(e("setState",{redirectUrl:t.redirectUrl}),P(e,i.REDIRECT_SCREEN)):"DECLINED"===t.status.toUpperCase()&&(e("setState",{redirectUrl:t.redirectUrl}),P(e),window.location.href=t.redirectUrl)},D=function(){var e=(0,u.A)((function*(e){const t=yield A.A.account.fetchUserInfo({});return!!t&&(e("setState",{userId:t.id}),t)}));return function(t){return e.apply(this,arguments)}}(),O=e=>e?`***-****-${e.slice(-4)}`:"",y=(e,t,n)=>{const o={};if(t.screenType===r.DESKTOP)if(n&&n.response){var s,c,l,d;const{data:e}=n.response;o.mode=(null===(s=e.resultInfo)||void 0===s?void 0:s.code)||i.UNDEFINED,o.redirectUrl=null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.redirectUrl,o.maskedPhoneNumber=null!==e&&void 0!==e&&null!==(l=e.data)&&void 0!==l&&l.maskedPhoneNumber?O(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.maskedPhoneNumber):""}else o.mode=i.UNDEFINED,o.lastError=a.UNKNOWN_ERROR;else if(n&&n.response){var u,E,I,S;const{data:e}=n.response;o.lastError=(null===(u=e.resultInfo)||void 0===u?void 0:u.code)||a.UNKNOWN_ERROR,o.maskedPhoneNumber=null!==e&&void 0!==e&&null!==(E=e.data)&&void 0!==E&&E.maskedPhoneNumber?O(null===e||void 0===e||null===(I=e.data)||void 0===I?void 0:I.maskedPhoneNumber):"",o.redirectUrl=null===e||void 0===e||null===(S=e.data)||void 0===S?void 0:S.redirectUrl}else o.lastError=a.UNKNOWN_ERROR;e("setState",o)},L={setState({commit:e},t){e("setState",t)},getAccLinkInfoAsync({commit:e,state:t,dispatch:n},a){return(0,u.A)((function*(){t.accLinkInfoStatus!==o.ERROR&&e("setState",{accLinkInfoStatus:o.FETCHING});const[,s]=yield A.A.paylite.getQrCodeFetch({code:a});let c=null,l=null;if(!s)return e("setState",{accLinkInfoStatus:o.ERROR}),!1;if(c=s.apple_account_link_qr_data,l=T(s),!s||!c||!l)return e("setState",{accLinkInfoStatus:o.ERROR}),!1;const d=yield A.A.getServerTimestamp();if(!d)return e("setState",{accLinkInfoStatus:o.ERROR}),!1;const u=d.timestamp/1e3;let E=0;E=c.expiresAt;const I=u<E;if(e("setState",{accLinkInfo:l,accLinkInfoStatus:I?o.FETCHED:o.EXPIRED}),t.screenType===r.DESKTOP){setTimeout((()=>n("startCheckingLinkStatus")));const o=[i.CODE_EXPIRED,i.REDIRECT_SCREEN].includes(t.mode);let r=Math.floor(E-u);if(!o){const t=setInterval((()=>{r>0&&!o?(e("setState",{expiryTimer:r}),--r):(e("setState",{mode:i.CODE_EXPIRED}),clearInterval(t))}),1e3)}}return yield new Promise((e=>setTimeout(e,500))),I}))()},signVerifyOtpAsync({commit:e,state:t},n){return(0,u.A)((function*(){if(t.isSignProcessing)return l.ALREADY_PROCESSING;e("setState",{isSignProcessing:!0});const[o]=t.mode===i.SIGN_IN_OTP?yield A.A.userModule.oauthTokenOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:parseInt(n.otp,10)}):yield A.A.userModule.signUpMobileValidateOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:n.otp});return o||setTimeout((()=>e("setState",{isSignProcessing:!1})),250),o?l.SUCCESS:l.FAILED}))()},signWithMobileAsync({commit:e,state:t},n){return(0,u.A)((function*(){if(t.isSignProcessing)return[c.ALREADY_PROCESSING];e("setState",{isSignProcessing:!0,isSignErrorTipDisplayed:!1});const[,o,r]=t.mode===i.SIGN_IN?yield A.A.userModule.oauthTokenPassword(n):yield A.A.userModule.signUpMobile({mobile:n.username,password:n.password}),a=Boolean(o&&o.otp_reference_id),s=Boolean(o&&o.access_token);switch(setTimeout((()=>e("setState",{isSignProcessing:!1})),250),!0){case a:return o&&o.otp_reference_id?[c.OTP_REQUIRED,o.otp_reference_id,o.otp_prefix]:[c.FAILED];case s:return[c.SUCCESS];default:switch(t.mode){case i.SIGN_IN:e("setState",{isSignErrorTipDisplayed:!0,errorCode:r&&r.response&&r.response.data&&r.response.data.result_info&&r.response.data.result_info.result_msg||""});break;case i.SIGN_UP:if((()=>{const e=o||r&&r.response&&r.response.data;return e&&e.result_info&&"01103104"===e.result_info.result_code_id})())e("setState",{isSignErrorTipDisplayed:!0});else{const t=p.p.createError("UM_GENERIC",o,r);e("setState",{displayInfo:t})}break}return[c.FAILED]}}))()},getViewInfoOfAppleAccountLinking({commit:e,state:t,dispatch:n},i){return(0,u.A)((function*(){const o=i;try{const{data:e}=yield(0,S.yI)({codeId:o});return yield n("mapViewInfoOfAppleAccountLinking",e)}catch(r){y(e,t,r)}return!1}))()},initiateAccountLinking({commit:e,state:t,dispatch:n},i){return(0,u.A)((function*(){try{const{data:e}=yield(0,S._o)({clientId:i});return yield n("mapViewInfoOfAppleAccountLinking",e)}catch(o){y(e,t,o)}return!1}))()},mapViewInfoOfAppleAccountLinking({commit:e,dispatch:t},n){return(0,u.A)((function*(){const{resultInfo:i,data:o}=n;return i.code===a.SUCCESS?(e("setState",{lastError:i.code,maskedPhoneNumber:O(o.maskedPhoneNumber),permissions:o.scopes,clientName:o.clientName,clientLogo:o.clientLogo}),o.sessionId&&e("setState",{sessionId:o.sessionId}),yield t("resetExpireTimer",o.expiresAt),!0):(e("setState",{lastError:i.code,redirectUrl:o.redirectUrl}),!1)}))()},getUserInfoAsync({commit:e,rootGetters:t,rootState:n}){return(0,u.A)((function*(){e("setState",{isSignProcessing:!0,userDisplayInfoStatus:o.FETCHING});const r=yield D(e);let a;return r&&(a=C.createFromUserModule(r)),r?(e("setState",{mode:i.ACC_LINK,isSignProcessing:!1,userDisplayInfo:a,userDisplayInfoStatus:o.FETCHED}),!0):(n.otp.referenceId?e("setState",{isSignProcessing:!1,mode:t.signInformation(n).signIn?i.SIGN_IN_OTP:i.SIGN_UP_OTP}):e("setState",{mode:i.SIGN_IN,isSignProcessing:!1}),!1)}))()},appleMakeDecision({commit:e,state:t,getters:n},{decision:i,sessionId:o,isTimeoutOnAppOrMobile:r}){return(0,u.A)((function*(){try{e("setState",{decision:i}),m&&clearInterval(m);const t=n.isBindingMode?S.b9:S.sm,{data:s}=yield t({codeId:o,decision:i}),{redirectUrl:c}=null===s||void 0===s?void 0:s.data;return e("setState",r?{redirectUrl:c,lastError:a.TIMEOUT}:{redirectUrl:c,lastError:s.resultInfo.code}),s.resultInfo.code===a.SUCCESS}catch(s){return y(e,t,s),!1}}))()},startCheckingLinkStatus({commit:e,state:t}){return(0,u.A)((function*(){e("setState",{isPollingStarted:!0}),m=window.setInterval((0,u.A)((function*(){if(t.isPollingStarted&&-1===[i.PROCESSING].indexOf(t.mode)){var n,o,r;let t;try{t=yield(0,S.cx)()}catch(a){P(e,i.CODE_EXPIRED)}if(!t||"SUCCESS"!==(null===(n=t)||void 0===n||null===(o=n.data)||void 0===o||null===(r=o.resultInfo)||void 0===r?void 0:r.code))return void P(e,i.CODE_EXPIRED);const{data:s}=t.data;s&&f(e,s)}})),2e3)}))()},signOutAsync({commit:e,state:t}){return(0,u.A)((function*(){e("setState",{isSignProcessing:!0}),yield A.A.logout(),(0,E.sw)();const n=(0,d.A)((0,d.A)({},R()),{},{isSignProcessing:!0,mode:t.mode===i.REDIRECT_SCREEN?i.REDIRECT_SCREEN:i.SIGN_IN,screenType:t.screenType,accLinkInfo:t.accLinkInfo,accLinkInfoStatus:t.accLinkInfoStatus});setTimeout((()=>e("setState",n)),500),setTimeout((()=>e("setState",{isSignProcessing:!1})),1e3)}))()},resetExpireTimer({commit:e},t){return(0,u.A)((function*(){let n;const i=yield A.A.getServerTimestamp();return n=i?Math.floor(i.timestamp/1e3):Math.floor(Date.now()/1e3),e("setState",{expiryTimer:t-n}),!0}))()},startRedirectTimer({commit:e}){let t=3;return e("setState",{redirectTimer:t}),new Promise((n=>{setTimeout((()=>{setInterval((()=>{t>=0?(e("setState",{redirectTimer:t}),t--):n(!0)}),1e3)}),1e3)}))},initAppleInAppBinding({commit:e,state:t,dispatch:n}){return(0,u.A)((function*(){if(t.mode===i.ACC_BIND||t.sessionId)return s.IDLE;const o=">=4.13.0",r=">=16.4";e("setState",{isBindingProcessing:!0,mode:i.ACC_BIND});try{if((0,_._5)(r)&&(0,I.J_)()&&(0,I.kp)(o)){const e=yield n("initiateAccountLinking","apple-client-id");return e?s.SUCCESS:s.ERROR}return s.REDIRECTED}finally{setTimeout((()=>e("setState",{isBindingProcessing:!1})),500)}}))()},getInAppBindingUrlFromStatus({state:e},t){const n={web:{SUCCESS:"applePermissionWeb",ERROR:"appleErrorWeb",REDIRECTED:"https://apps.apple.com/account/billing",IDLE:""},native:{SUCCESS:"applePermission",ERROR:"appleError",REDIRECTED:"https://apps.apple.com/account/billing",IDLE:""}};return"MOBILE"===e.screenType||"DESKTOP"===e.screenType?n.web[t]||"":n.native[t]||""}},g={permissions:({permissions:e})=>e,lastError:({lastError:e})=>e,errorCode:({errorCode:e})=>e,redirectUrl:({redirectUrl:e})=>e,redirectTimerHandle:({redirectTimerHandle:e})=>e,maskedPhoneNumber:({maskedPhoneNumber:e})=>e,sessionId:({sessionId:e})=>e,isScreenModeDesktop:({screenType:e})=>e===r.DESKTOP,isScreenModeMobile:({screenType:e})=>e===r.MOBILE,isSignInUpDisplayed:({mode:e})=>Boolean(e===i.SIGN_IN||e===i.SIGN_UP),isSignErrorTipDisplayed:({isSignErrorTipDisplayed:e})=>e,isSignOtpDisplayed:({mode:e})=>Boolean(e===i.SIGN_IN_OTP||e===i.SIGN_UP_OTP),isAccountLinkDisplayed:({mode:e})=>Boolean(e===i.ACC_LINK||e===i.ACC_BIND),isProfileMenuButtonVisible:({isProfileMenuButtonVisible:e})=>e,isRedirectScreenDisplayed:({mode:e,accLinkInfoStatus:t})=>[i.REDIRECT_SCREEN].includes(e)&&![o.ERROR,o.EXPIRED].includes(t),isProcessingDisplayed:({mode:e})=>e===i.PROCESSING,isFetchingErrorQrCodeDisplayed:({accLinkInfoStatus:e,mode:t})=>[o.ERROR,o.EXPIRED].includes(e)||[i.CODE_EXPIRED,i.UNAUTHORIZED,i.AUTHORIZATION_SESSION_UNEXPECTED_STATUS,i.AUTHORIZATION_SESSION_EXPIRED,i.UNDEFINED].includes(t),mode:({mode:e})=>e,screenType:({screenType:e})=>e,isPollingStarted:({isPollingStarted:e})=>e,isSignProcessing:({isSignProcessing:e})=>e,isFetchingData:({isFetchingData:e})=>e,accLinkInfo:({accLinkInfo:e})=>e,accLinkInfoStatus:({accLinkInfoStatus:e})=>e,merchantInfo:({accLinkInfo:e})=>e?e.merchant:{},codeId:({accLinkInfo:e})=>e&&e.codeId||"",userDisplayInfo:({userDisplayInfo:e})=>e,userDisplayInfoStatus:({userDisplayInfoStatus:e})=>e,displayInfo:({displayInfo:e})=>e,isModalProfileBoxVisible:({isModalProfileBoxVisible:e})=>e,isLoadingScreenVisible:({isSignProcessing:e})=>Boolean(e),isScreenBlur:({displayInfo:e})=>Boolean(e.isVisible),redirectTimer:({redirectTimer:e})=>e,expiryTimer:({expiryTimer:e})=>e,clientName:({clientName:e})=>e,clientLogo:({clientLogo:e})=>e,decision:({decision:e})=>e,userId:({userId:e})=>e,isScanMode:({isScanMode:e})=>e,isBindingMode:({mode:e})=>e===i.ACC_BIND,isBindingProcessing:({isBindingProcessing:e})=>e},U={setState(e,t){Object.assign(e,t)}},v={namespaced:!0,actions:L,getters:g,mutations:U,state:R()}},76897:function(e,t,n){n.d(t,{b1:function(){return r},te:function(){return o},eU:function(){return i},s4:function(){return p}});var i,o,r,a=n(75805),s=n(5258);function c(e,t){var n,i,o,r;const a=null!==(n=null===(i=e.permissionView)||void 0===i?void 0:i.data.payload.scopes)&&void 0!==n?n:[],s={interaction_outcome:{extension_id:null!==(o=null===(r=e.permissionView)||void 0===r?void 0:r.extension_id)&&void 0!==o?o:"",data:{type:"USER_DECISION",payload:{authorized_scopes:a,decision:t}}}};return s}function l(e,t,n){var o;if(!t)return!1;if("SUCCESS"===(null===t||void 0===t||null===(o=t.result_info)||void 0===o?void 0:o.result_code)){let o="";return o=e===i.Accepted?t.data.redirect_uri:t.data.error_redirect_uri,n("setState",{redirectUri:o}),!0}return!1}(function(e){e["Accepted"]="Accepted",e["Declined"]="Declined"})(i||(i={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["APP"]="APP"}(o||(o={})),function(e){e["Created"]="Created",e["Started"]="Started",e["Complete"]="Complete"}(r||(r={}));const d={getPermissionViewData({commit:e,state:t}){return(0,a.A)((function*(){try{var n,i;const o={interaction_outcome:null},r=yield(0,s.d)(t.requestUri,o);return"SUCCESS"===(null===r||void 0===r||null===(n=r.data)||void 0===n||null===(i=n.result_info)||void 0===i?void 0:i.result_code)&&(e("setState",{permissionView:r.data.data.request}),!0)}catch(o){return!1}}))()},postUserDecision({commit:e,state:t},n){return(0,a.A)((function*(){const i=c(t,n);try{const o=yield(0,s.U)(t.requestUri,i);return l(n,null===o||void 0===o?void 0:o.data,e)}catch(o){return!1}}))()}};var u=n(80760),E=n(6634);const I={permissionView({permissionView:e}){return e},merchantLogo({permissionView:e}){var t;return null!==(t=null===e||void 0===e?void 0:e.data.payload.client_logo)&&void 0!==t?t:""},scopes({permissionView:e}){var t;return null!==(t=null===e||void 0===e?void 0:e.data.payload.scopes)&&void 0!==t?t:[]},termsAndConditions({permissionView:e}){var t;return null===e||void 0===e||null===(t=e.data.payload)||void 0===t?void 0:t.terms_condition},agreeCheckbox({permissionView:e}){var t;return null===e||void 0===e||null===(t=e.data.payload)||void 0===t?void 0:t.agree_checkbox},privacyPolicy({permissionView:e}){var t;return null===e||void 0===e||null===(t=e.data.payload)||void 0===t?void 0:t.privacy_policy},accountLinkFooterText({permissionView:e}){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.data.payload)||void 0===n?void 0:n.account_link_footer_text)&&void 0!==t?t:""},clientLogo({permissionView:e}){return null===e||void 0===e?void 0:e.data.payload.client_logo},clientName({permissionView:e}){return null===e||void 0===e?void 0:e.data.payload.client_name},isProcessing({isProcessing:e}){return e},maskedPhoneNumber({permissionView:e}){return(null===e||void 0===e?void 0:e.data.payload.masked_phone_number)||"***-****-****"},redirectUri({redirectUri:e}){return e},screenType(){return(0,u.J_)()?o.APP:window.innerWidth>E.PK.DESKTOP_MIN_WIDTH?o.DESKTOP:o.MOBILE},userAgent({parCheck:e}){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.client_info)||void 0===n?void 0:n.user_agent)&&void 0!==t?t:""},parCheckRedirectUri({parCheck:e}){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.client_info)||void 0===n?void 0:n.redirect_uri)&&void 0!==t?t:""}},S={setState(e,t){Object.assign(e,t)}},A=()=>({requestUri:"",redirectUri:"",permissionView:null,isProcessing:!1,parCheck:null}),p={namespaced:!0,actions:d,getters:I,mutations:S,state:A()}},56060:function(e,t,n){n.d(t,{O4:function(){return o},Fn:function(){return a},_t:function(){return i},te:function(){return r},fR:function(){return s},DZ:function(){return D}});var i,o,r,a,s,c,l=n(5873),d=n(75805),u=(n(74423),n(27495),n(25440),n(62953),n(68997)),E=n(96470),I=n(24909),S=n(25618),A=n(6634),p=n(57464);class _{static createFromPaylite(e){if(!e||!e.account_link_qr_data)return null;const t=e.account_link_qr_data,n=e.account_link_qr_data.clientSettings;return{code:e.code,clientId:t.clientId||"",phoneNumber:t.phoneNumber||"",merchant:{name:t.clientName,logoUrl:null===n||void 0===n?void 0:n.clientLogo,permissions:t.permissions,redirectUrl:t.redirectUrl,privacyPolicy:null===n||void 0===n?void 0:n.privacyPolicy,termsCondition:null===n||void 0===n?void 0:n.termsCondition,isKyc:null===n||void 0===n?void 0:n.kycCheck,accountLinkFooterText:null===n||void 0===n?void 0:n.accountLinkFooterText,agreeCheckbox:null===n||void 0===n?void 0:n.agreeCheckbox,disableSignUp:null===n||void 0===n?void 0:n.disableSignUp}}}}class T{static createFromUserModule(e){if(!e)return null;const t=e.mobile?(0,p.C)("***-****-XXXX",e.mobile):"",i=e.user_defined_id,o=e.is_already_set_display_name?e.display_name:t;return{identification:t||i||"",displayName:o||"",photoUrl:e.photo_url||n(20616),id:e.id,externalId:e.external_id,mobile:e.mobile||""}}}(function(e){e["CODE_EXPIRED"]="CODE_EXPIRED",e["ACC_LINK"]="ACC_LINK",e["REDIRECT_SCREEN"]="REDIRECT_SCREEN",e["ERROR"]="ERROR",e["PROCESSING"]="PROCESSING",e["SIGN_IN"]="SIGN_IN",e["SIGN_IN_OTP"]="SIGN_IN_OTP",e["SIGN_UP"]="SIGN_UP",e["SIGN_UP_OTP"]="SIGN_UP_OTP",e["KYC_NOT_COMPLETED"]="KYC_NOT_COMPLETED",e["KYC_DATA_MISMATCH"]="KYC_DATA_MISMATCH",e["INTENT_CLICKED"]="INTENT_CLICKED",e["UNDEFINED"]="UNDEFINED",e["TIMEOUT_ERROR"]="TIMEOUT_ERROR",e["LINK_ERROR"]="LINK_ERROR",e["KYC_ERROR"]="KYC_ERROR",e["LINKING_FAILED"]="LINKING_FAILED",e["AGE_ERROR"]="AGE_ERROR",e["KYC_SPECIFIED_NOT_COMPLETED"]="KYC_SPECIFIED_NOT_COMPLETED",e["PAYLATERCC_REVIEW_PENDING"]="PAYLATERCC_REVIEW_PENDING",e["MISSING_VIRTUAL_ACCOUNT"]="MISSING_VIRTUAL_ACCOUNT",e["VIRTUAL_ACCOUNT_NOT_VALID_STATE"]="VIRTUAL_ACCOUNT_NOT_VALID_STATE"})(i||(i={})),function(e){e["PAY_PAY_USER_ALREADY_LINKED"]="PAY_PAY_USER_ALREADY_LINKED",e["CLIENT_USER_ALREADY_LINKED"]="CLIENT_USER_ALREADY_LINKED",e["USER_NOT_FOUND"]="USER_NOT_FOUND",e["KYC_NOT_COMPLETED"]="KYC_NOT_COMPLETED",e["INVALID_REQUEST_PARAMS"]="INVALID_REQUEST_PARAMS",e["SESSION_NOT_FOUND"]="SESSION_NOT_FOUND",e["MIN_KYC_AGE_ERROR"]="MIN_KYC_AGE_ERROR",e["KYC_SPECIFIED_NOT_COMPLETED"]="KYC_SPECIFIED_NOT_COMPLETED",e["PAYLATERCC_REVIEW_PENDING"]="PAYLATERCC_REVIEW_PENDING",e["MISSING_VIRTUAL_ACCOUNT"]="MISSING_VIRTUAL_ACCOUNT",e["VIRTUAL_ACCOUNT_NOT_VALID_STATE"]="VIRTUAL_ACCOUNT_NOT_VALID_STATE"}(o||(o={})),function(e){e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["UNDEFINED"]="UNDEFINED",e["APP"]="APP"}(r||(r={})),function(e){e["INITIAL"]="INITIAL",e["FETCHING"]="FETCHING",e["FETCHED"]="FETCHED",e["ERROR"]="ERROR",e["EXPIRED"]="EXPIRED"}(a||(a={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["OTP_REQUIRED"]="OTP_REQUIRED",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(s||(s={})),function(e){e["SUCCESS"]="SUCCESS",e["FAILED"]="FAILED",e["FAILED_NOT_MATCH"]="FAILED_NOT_MATCH",e["ALREADY_PROCESSING"]="ALREADY_PROCESSING"}(c||(c={}));const C=()=>({displayInfo:S.p.createDefault(),mode:i.SIGN_IN,screenType:r.UNDEFINED,isSecondaryBrowser:!1,isPollingStarted:!1,isSignProcessing:!1,isModalProfileBoxVisible:!1,isProfileMenuButtonVisible:!0,accLinkInfo:null,accLinkInfoStatus:a.INITIAL,isRedirectScreenDisplayed:!1,isSignErrorTipDisplayed:!1,errorCode:"",userDisplayInfo:null,userDisplayInfoStatus:a.INITIAL,redirectTimer:0,redirectUrl:null,expiryTimer:0,isFetchingData:!1,isSmartPaymentProcessing:!1,isAutoMandateProcessing:!1,counterIntervalId:null,systemAnnouncementBannerInfo:null,signInMethods:[],showAsyncLoader:!1});var N=n(75005);let R;const m={setState({commit:e},t){e("setState",t)},getAccLinkInfoAsync({commit:e,dispatch:t,state:n},o){return(0,d.A)((function*(){n.accLinkInfoStatus!==a.ERROR&&e("setState",{accLinkInfoStatus:a.FETCHING});const[,r]=yield I.A.paylite.getQrCodeFetch({code:o});let s=null,c=null;if(!r)return e("setState",{accLinkInfoStatus:a.ERROR}),!1;var l;if(null!==(l=r.account_link_qr_data)&&void 0!==l&&l.isWebDisabled)return void window.location.replace("https://paypay.onelink.me/U7U6/skx4uuu0");if(s=r.account_link_qr_data,c=_.createFromPaylite(r),!r||!s||!c)return e("setState",{accLinkInfoStatus:a.ERROR}),!1;const d=yield I.A.getServerTimestamp();if(!d)return e("setState",{accLinkInfoStatus:a.ERROR}),!1;const u=d.timestamp/1e3;let E=0;E=s.expiresAt;const S=u<E;e("setState",{accLinkInfo:c,accLinkInfoStatus:S?a.FETCHED:a.EXPIRED}),S&&setTimeout((()=>t("startCheckingLinkStatus")));const A=[i.CODE_EXPIRED,i.ERROR,i.REDIRECT_SCREEN].includes(n.mode);let p=Math.floor(E-u);if(!A){const t=setInterval((()=>{p>0&&!A?(e("setState",{expiryTimer:p}),--p):(e("setState",{mode:i.TIMEOUT_ERROR}),clearInterval(t),e("setState",{counterIntervalId:null}))}),1e3);e("setState",{counterIntervalId:t})}return yield new Promise((e=>setTimeout(e,500))),S}))()},getUserInfoAsync({commit:e,rootGetters:t,rootState:n}){return(0,d.A)((function*(){e("setState",{isSignProcessing:!0,userDisplayInfoStatus:a.FETCHING});const o=yield I.A.account.fetchUserInfo({}),r=T.createFromUserModule(o);return r?(e("setState",{mode:i.ACC_LINK,isSignProcessing:!1,userDisplayInfo:r,userDisplayInfoStatus:a.FETCHED,signInMethods:null===o||void 0===o?void 0:o.sign_in_methods}),!0):(n.otp.referenceId?e("setState",{isSignProcessing:!1,mode:t.signInformation(n).signIn?i.SIGN_IN_OTP:i.SIGN_UP_OTP}):e("setState",{mode:i.SIGN_IN,isSignProcessing:!1}),!1)}))()},signOutAsync({commit:e,dispatch:t,state:n}){return(0,d.A)((function*(){e("setState",{isSignProcessing:!0}),yield I.A.logout(),(0,E.sw)();const o=(0,l.A)((0,l.A)({},C()),{},{isSignProcessing:!0,mode:n.mode===i.REDIRECT_SCREEN?i.REDIRECT_SCREEN:i.SIGN_IN,screenType:n.screenType,accLinkInfo:n.accLinkInfo,accLinkInfoStatus:n.accLinkInfoStatus});setTimeout((()=>e("setState",o)),500),setTimeout((()=>{e("setState",{isSignProcessing:!1}),t("openApi/updateErrorMode",null,{root:!0})}),1e3)}))()},signWithMobileAsync({commit:e,state:t},n){return(0,d.A)((function*(){if(t.isSignProcessing)return[s.ALREADY_PROCESSING];e("setState",{isSignProcessing:!0,isSignErrorTipDisplayed:!1});const[,o,r]=t.mode===i.SIGN_IN?yield I.A.userModule.oauthTokenPassword(n):yield I.A.userModule.signUpMobile({mobile:n.username,password:n.password}),a=Boolean(o&&o.otp_reference_id),c=Boolean(o&&o.access_token);switch(setTimeout((()=>e("setState",{isSignProcessing:!1})),250),!0){case a:return o&&o.otp_reference_id?[s.OTP_REQUIRED,o.otp_reference_id,o.otp_prefix]:[s.FAILED];case c:return[s.SUCCESS];default:switch(t.mode){case i.SIGN_IN:e("setState",{isSignErrorTipDisplayed:!0,errorCode:r&&r.response&&r.response.data&&r.response.data.result_info&&r.response.data.result_info.result_msg||""});break;case i.SIGN_UP:if((()=>{const e=o||r&&r.response&&r.response.data;return e&&e.result_info&&"01103104"===e.result_info.result_code_id})())e("setState",{isSignErrorTipDisplayed:!0});else{const t=S.p.createError("UM_GENERIC",o,r);e("setState",{displayInfo:t})}break}return[s.FAILED]}}))()},signVerifyOtpAsync({commit:e,state:t},n){return(0,d.A)((function*(){if(t.isSignProcessing)return c.ALREADY_PROCESSING;e("setState",{isSignProcessing:!0});const[o]=t.mode===i.SIGN_IN_OTP?yield I.A.userModule.oauthTokenOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:parseInt(n.otp,10)}):yield I.A.userModule.signUpMobileValidateOtp({otp_prefix:n.otpPrefix,otp_reference_id:n.id,otp:n.otp});return o||setTimeout((()=>e("setState",{isSignProcessing:!1})),250),o?c.SUCCESS:c.FAILED}))()},startRedirectTimer({commit:e}){let t=3;return e("setState",{redirectTimer:t}),new Promise((n=>{setTimeout((()=>{setInterval((()=>{t>=0?(e("setState",{redirectTimer:t}),t--):n(!0)}),1e3)}),1e3)}))},startCheckingLinkStatus({commit:e,state:t,rootGetters:n}){return(0,d.A)((function*(){e("setState",{isPollingStarted:!0}),R=window.setInterval((0,d.A)((function*(){if(t.isPollingStarted&&-1===[i.ERROR,i.PROCESSING,i.KYC_DATA_MISMATCH,i.KYC_NOT_COMPLETED,i.INTENT_CLICKED].indexOf(t.mode)){const o=yield I.A.openApi.checkAccountLinkStatus();if(!o||o===A.OQ.SESSION_NOT_FOUND)return clearInterval(R),void e("setState",{isPollingStarted:!1,mode:i.CODE_EXPIRED});const{data:r}=o;if(r&&("ACCEPTED"===r.accountLinkStatus||"DECLINED"===r.accountLinkStatus)){let o=r.callbackUrl;if(o+=o.indexOf("?")>-1?"&":"?",r.callbackParams&&(o+=u.A.stringify(r.callbackParams)),"ACCEPTED"===r.accountLinkStatus)n["openApi/isAutoTopupMandate"]||setTimeout((()=>{e("setState",{mode:i.REDIRECT_SCREEN,redirectUrl:o})}),500);else{const e=n["openApi/paylaterCCStatus"];if(n["openApi/isPPCDOnlyClientMandate"]&&(e===N.b5.INACTIVE||e===N.b5.REVIEWING))return;clearInterval(R),t.isPollingStarted=!1,window.location.href=o}clearInterval(R),t.isPollingStarted=!1}}})),2e3)}))()},stopPolling(){R&&clearInterval(R)},clearTimerIntervalId({commit:e,state:t}){null!==t.counterIntervalId&&(clearInterval(t.counterIntervalId),e("setState",{counterIntervalId:null}))},getSystemAnnouncementBannerInfo({commit:e},t){return(0,d.A)((function*(){let n="";switch(t.screenType){case"SIGN_IN":n="SIGNIN";break;case"SIGN_UP":n="SIGNUP";break}if(n)try{const[t,i]=yield I.A.bff.getSystemAnnouncementBannerInfo(n);t&&e("setState",{systemAnnouncementBannerInfo:null===i||void 0===i?void 0:i.payload.systemAnnouncementBannerInfo})}catch(i){}}))()}},P={mode:({mode:e})=>e,screenType:({screenType:e})=>e,isSecondaryBrowser:({isSecondaryBrowser:e})=>e,isPollingStarted:({isPollingStarted:e})=>e,isSignProcessing:({isSignProcessing:e})=>e,isFetchingData:({isFetchingData:e})=>e,isProcessingDisplayed:({mode:e})=>e===i.PROCESSING,isSmartPaymentProcessing:({isSmartPaymentProcessing:e})=>e,accLinkInfo:({accLinkInfo:e})=>e,accLinkInfoStatus:({accLinkInfoStatus:e})=>e,merchantInfo:({accLinkInfo:e})=>e?e.merchant:{},isFetchingErrorQrCodeDisplayed:({accLinkInfoStatus:e,mode:t})=>[a.ERROR,a.EXPIRED].includes(e)||[i.ERROR,i.KYC_DATA_MISMATCH,i.KYC_NOT_COMPLETED,i.CODE_EXPIRED,i.LINKING_FAILED,i.VIRTUAL_ACCOUNT_NOT_VALID_STATE].includes(t),isRedirectScreenDisplayed:({mode:e,accLinkInfoStatus:t})=>[i.REDIRECT_SCREEN].includes(e)&&![a.ERROR,a.EXPIRED].includes(t),codeId:({accLinkInfo:e})=>e&&e.codeId||"",userDisplayInfo:({userDisplayInfo:e})=>e,userDisplayInfoStatus:({userDisplayInfoStatus:e})=>e,displayInfo:({displayInfo:e})=>e,isModalProfileBoxVisible:({isModalProfileBoxVisible:e})=>e,isProfileMenuButtonVisible:({isProfileMenuButtonVisible:e})=>e,isLoadingScreenVisible:({isSignProcessing:e,isSmartPaymentProcessing:t,isAutoMandateProcessing:n,showAsyncLoader:i})=>Boolean(e||t||n||i),isScreenModeDesktop:({screenType:e})=>e===r.DESKTOP,isScreenModeMobile:({screenType:e})=>e===r.MOBILE,isSignErrorTipDisplayed:({isSignErrorTipDisplayed:e})=>e,isSignInUpDisplayed:({mode:e})=>Boolean(e===i.SIGN_IN||e===i.SIGN_UP),isSignOtpDisplayed:({mode:e})=>Boolean(e===i.SIGN_IN_OTP||e===i.SIGN_UP_OTP),isAccountLinkDisplayed:({mode:e})=>Boolean(e===i.ACC_LINK),isTimeoutErrorDisplayed:({mode:e})=>Boolean(e===i.TIMEOUT_ERROR),isLinkingErrorDisplayed:({mode:e})=>Boolean(e===i.LINK_ERROR||e===i.PAYLATERCC_REVIEW_PENDING),isKycErrorDisplayed:({mode:e})=>Boolean(e===i.KYC_ERROR),isAgeErrorDisplayed:({mode:e})=>Boolean(e===i.AGE_ERROR),isSpecificKycErrorDisplayed:({mode:e})=>Boolean(e===i.KYC_SPECIFIED_NOT_COMPLETED),isNonPayrollUser:({mode:e})=>Boolean(e===i.MISSING_VIRTUAL_ACCOUNT),suspendedPayrollUser:({mode:e})=>Boolean(e===i.VIRTUAL_ACCOUNT_NOT_VALID_STATE),isScreenBlur:({displayInfo:e})=>Boolean(e.isVisible),redirectTimer:({redirectTimer:e})=>e,redirectUrl:({redirectUrl:e})=>e||"",expiryTimer:({expiryTimer:e})=>e,systemAnnouncementBannerInfo:({systemAnnouncementBannerInfo:e})=>e,isSoftBankUser:({signInMethods:e})=>e.some((e=>"SOFTBANK_ID"===e.sign_in_method_provider))},f={setState(e,t){Object.assign(e,t)},updateRedirectUrl(e,t){e.redirectUrl=t},updateMode(e,t){e.mode=t},updateExpiryTimer(e,t){e.expiryTimer=t}},D={namespaced:!0,actions:m,getters:P,mutations:f,state:C()}},75005:function(e,t,n){n.d(t,{lF:function(){return l.lF},c6:function(){return d.c6},b5:function(){return l.b5},te:function(){return l.te},Nd:function(){return N}});var i=n(75805),o=(n(16280),n(74423),n(44114),n(33110),n(23500),n(62953),n(68997)),r=n(14516),a=n(30714),s=n(24909),c=n(42157),l=n(28991),d=n(24494),u=n(56060);const E=(e,t)=>{var n,i,o;const r=null===t||void 0===t||null===(n=t.viewContext)||void 0===n||null===(i=n.mandates)||void 0===i||null===(o=i.continuousPayment)||void 0===o?void 0:o.preTransactionAutoCharge;let a=!1,s=!1;(null===r||void 0===r?void 0:r.clientMandate)===l.bX.MANDATED&&(a=!0),"ENABLED"===(null===r||void 0===r?void 0:r.userSetting)&&(s=!0),e("setState",{isAutoTopupMandate:a,isPreTransactionAutoTopupEnabled:s,merchantOpaConfig:t})};let I;const S={declineAccountLinking({commit:e}){return(0,i.A)((function*(){const t=yield s.A.openApi.sendUserDecision("declined");if(t&&t.resultInfo&&["SUCCESS","3RD_PARTY_BAD_REQUEST","S"].includes(t.resultInfo.code)){var n;let i=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.callbackUrl;i&&(i+=i.indexOf("?")>-1?"&":"?",null!==t&&void 0!==t&&t.data.callbackParams&&(i+=o.A.stringify(t.data.callbackParams)));const r={callbackUrl:i||null};e("setState",r)}else c.A.captureExceptionWithScope.error(new Error(`[Error] declineAccountLinking: ${t}`))}))()},enablePreTransactionAutoTopup({commit:e,state:t}){return(0,i.A)((function*(){var n,i,o;const r={isEnabled:!0,minimumTopupAmount:t.preTransactionMinimumTopupAmount,paymentMethodId:null===(n=t.activePaymentMethod)||void 0===n?void 0:n.paymentMethodIdString,paymentMethodType:null===(i=t.activePaymentMethod)||void 0===i?void 0:i.paymentMethodType};(null===(o=t.activePaymentMethod)||void 0===o?void 0:o.paymentMethodType)===a.eq.CREDIT_CARD&&(r.ccType=t.activePaymentMethod.creditCardInfo.ccType,r.isAuthenticated=t.activePaymentMethod.creditCardInfo.isAuthenticated);const[c,l]=yield s.A.bff.updatePreTransactionAutoTopupConfiguration(r);if(void 0===l)return Promise.reject();e("setState",{isUpdatePreTrxTopupConfigSuccess:c,updatePreTrxTopupConfigResponse:l})}))()},getAutoTopupConfig({commit:e},t=!1){return(0,i.A)((function*(){const[n,i,o]=yield s.A.bff.getAutoTopupConfig(t);if(void 0===i)return c.A.captureExceptionWithScope.error(new Error(`[Error] getAutoTopupConfig: ${null===o||void 0===o?void 0:o.message}`)),Promise.reject();var r;n&&i&&e("setState",{isPostTransactionAutoTopupEnabled:null===(r=i.payload)||void 0===r?void 0:r.autoTopupConfiguration.isEnabled})}))()},getAutoTopupConfigs({commit:e,dispatch:t,state:n},{includePostTransactionPaymentMethodList:o,includePreTransactionPaymentMethodList:r}){return(0,i.A)((function*(){e("setState",{autoTopupMode:l.lF.LOADING});const i=t("getAutoTopupConfig",o),a=t("getPreTransactionAutoTopupConfiguration",r);return Promise.all([a,i]).then((()=>{const t={};(n.isPostTransactionAutoTopupEnabled||n.isPreTransactionAutoTopupEnabled||!n.preTransactionPaymentMethodList||0!==n.preTransactionPaymentMethodList.length)&&d.ey.hasAnyActivePaymentMethod(n.preTransactionPaymentMethodList)?!n.isPostTransactionAutoTopupEnabled&&!n.isPreTransactionAutoTopupEnabled&&n.preTransactionPaymentMethodList&&n.preTransactionPaymentMethodList.length>0?t.autoTopupMode=l.lF.AUTO_TOPUP_DISABLED_WITH_PAYMENT_METHOD:n.isPostTransactionAutoTopupEnabled?t.autoTopupMode=l.lF.OLD_VERSION:n.isPreTransactionAutoTopupEnabled&&(t.autoTopupMode=l.lF.NEW_VERSION):t.autoTopupMode=l.lF.AUTO_TOPUP_DISABLED_WITH_NO_PAYMENT_METHOD,e("setState",t)})).catch((e=>(c.A.captureExceptionWithScope.fatal(new Error(`[Error] getAutoTopupConfigs: ${null===e||void 0===e?void 0:e.message}`)),Promise.reject())))}))()},getPreTransactionAutoTopupConfiguration({commit:e},t=!1){return(0,i.A)((function*(){const[n,i]=yield s.A.bff.getPreTransactionAutoTopupConfig(t);if(void 0===i)return Promise.reject();if(n&&i){var o,r,c;const t=null===(o=i.payload)||void 0===o||null===(r=o.preTransactionAutoTopupConfiguration)||void 0===r?void 0:r.paymentMethodIdString,n=(null===(c=i.payload)||void 0===c?void 0:c.paymentMethodList)||[],s=d.ey.filterUnAuthenticatedCreditCard(n);let l=0;s.forEach((e=>{e.paymentMethodType===a.eq.PAY_LATER_CC&&l++}));const u=d.ey.getActivePaymentMethod(n,t);e("setState",{preTransactionPaymentMethodList:s,activePaymentMethod:u,hasMultiplePPCD:l>1})}}))()},updateClient({commit:e},t){e("updateClient",t)},updateClientAsync({commit:e,dispatch:t},n){return(0,i.A)((function*(){const i=yield s.A.openApi.getClientView({authorization:n.authorization}),{redirect:o}=n;if(!i||"SUCCESS"!==i.resultInfo.code){c.A.captureExceptionWithScope.fatal(new Error(`[Error] updateClientAsync: ${JSON.stringify(i)}`));const{data:n}=i;return n&&e("updateClient",{phoneNumber:n.phoneNumber,redirectUrl:n.redirectUrl,logo:n.clientLogo,name:n.clientName,kycCompleted:n.kycCompleted,minKycAge:n.minKycAge}),[u.O4.KYC_SPECIFIED_NOT_COMPLETED,u.O4.MISSING_VIRTUAL_ACCOUNT,u.O4.VIRTUAL_ACCOUNT_NOT_VALID_STATE].includes(i.resultInfo.code)?(t("opaWeb/stopPolling",null,{root:!0}),e("updateErrorMode",i.resultInfo.code)):n&&!1===n.kycCompleted?e("updateErrorMode",u.O4.KYC_NOT_COMPLETED):e("updateErrorMode",i.resultInfo.code),!1!==o&&r.A.push("/error/invalid"),!1}{const{data:n}=i,c=n.viewContext;if(c){var a,d,S;if(E(e,n),e("updateClient",{name:c.clientName,clientId:c.clientId,phoneNumber:c.phoneNumber,permissions:c.permissions,logo:c.clientSettings.clientLogo,privacyPolicy:c.clientSettings.privacyPolicy,termsConditions:c.clientSettings.termsCondition,kycCheck:c.clientSettings.kycCheck,accountLinkFooterText:c.clientSettings.accountLinkFooterText,agreeCheckbox:c.clientSettings.agreeCheckbox,ageVerifyCheckbox:c.clientSettings.ageVerifyCheckbox,kycMandate:c.clientSettings.kycMandate,redirectUrl:c.redirectUrl,expiresAt:c.expiresAt,userAgent:c.userAgent,kycCompleted:c.kycCompleted,minKycAge:c.minKycAge,accountLinkTitle:c.accountLinkTitle}),(null===c||void 0===c||null===(a=c.mandates)||void 0===a||null===(d=a.continuousPayment)||void 0===d||null===(S=d.paylaterCC)||void 0===S?void 0:S.clientMandate)===l.bX.MANDATED){var A,p,_,T,C,N;if((null===c||void 0===c||null===(A=c.mandates)||void 0===A||null===(p=A.continuousPayment)||void 0===p||null===(_=p.paylaterCC)||void 0===_?void 0:_.paylaterCCStatus)===l.b5.INACTIVE)return t("opaWeb/stopPolling",null,{root:!0}),!1;if((null===c||void 0===c||null===(T=c.mandates)||void 0===T||null===(C=T.continuousPayment)||void 0===C||null===(N=C.paylaterCC)||void 0===N?void 0:N.paylaterCCStatus)===l.b5.REVIEWING)return t("opaWeb/stopPolling",null,{root:!0}),e("updateErrorMode",u.O4.PAYLATERCC_REVIEW_PENDING),!1}!1!==o&&r.A.push("/opa/client/view");const i=yield s.A.getServerTimestamp();if(!i)return e("updateErrorMode",u._t.ERROR),!1;const R=i.timestamp/1e3;let m=0;m=c.expiresAt;let P=Math.floor(m-R);return I&&clearInterval(I),I=window.setInterval((()=>{P>0?(e("updateExpiryTimer",P),--P):(e("updateErrorMode",u._t.TIMEOUT_ERROR),clearInterval(I))}),1e3),!0}}}))()},updateErrorMode({commit:e},t){e("updateErrorMode",t)},updateExpiryTimer({commit:e},t){e("updateExpiryTimer",t)},updateState({commit:e},t){e("setState",{autoTopupMode:t})},updateToupConfig({commit:e},t){e("setState",{topupConfig:t})}},A={activePaymentMethod:({activePaymentMethod:e})=>e,autoTopupMode:({autoTopupMode:e})=>e,displayInfo:({displayInfo:e})=>e,getPreTransactionPaymentMethodList:({preTransactionPaymentMethodList:e})=>e,isAutoTopupMandate:({isAutoTopupMandate:e})=>e,isPreTransactionAutoTopupEnabled:({isPreTransactionAutoTopupEnabled:e})=>e,isPostTransactionAutoTopupEnabled:({isPostTransactionAutoTopupEnabled:e})=>e,merchantOpaConfig:({merchantOpaConfig:e})=>e,preTransactionMinimumTopupAmount:({preTransactionMinimumTopupAmount:e})=>e,isUpdatePreTrxTopupConfigSuccess:({isUpdatePreTrxTopupConfigSuccess:e})=>e,screenType:({screenType:e})=>e,updatePreTrxTopupConfigResponse:({updatePreTrxTopupConfigResponse:e})=>e,callbackUrl:({callbackUrl:e})=>e,redirectUrl:({client:e})=>e.redirectUrl,userAgent:({client:e})=>e.userAgent,topupConfig:({topupConfig:e})=>e,client:({client:e})=>e,errorMode:({errorMode:e})=>e,openAPIexpiryTimer:({expiryTimer:e})=>e,merchantId:({client:e})=>e.clientId,isScanMode:({isScanMode:e})=>e,pageTitle:({pageTitle:e})=>e,hasMultiplePPCD:({hasMultiplePPCD:e})=>e,isPaylaterCC:({activePaymentMethod:e})=>(null===e||void 0===e?void 0:e.paymentMethodType)===a.eq.PAY_LATER_CC,isPPCDOnlyClientMandate:({merchantOpaConfig:e})=>{var t,n,i;const o=null===e||void 0===e||null===(t=e.viewContext)||void 0===t||null===(n=t.mandates)||void 0===n||null===(i=n.continuousPayment)||void 0===i?void 0:i.paylaterCC;return(null===o||void 0===o?void 0:o.clientMandate)===l.bX.MANDATED},paylaterCCStatus:({merchantOpaConfig:e})=>{var t,n,i;const o=null===e||void 0===e||null===(t=e.viewContext)||void 0===t||null===(n=t.mandates)||void 0===n||null===(i=n.continuousPayment)||void 0===i?void 0:i.paylaterCC;return null===o||void 0===o?void 0:o.paylaterCCStatus},merchantCallbackParams:({merchantOpaConfig:e})=>{var t;return null===e||void 0===e||null===(t=e.viewContext)||void 0===t?void 0:t.callbackParams}},p={setState(e,t){Object.assign(e,t)},updateClient(e,t){e.client=t},updateErrorMode(e,t){e.errorMode=t},updateExpiryTimer(e,t){e.expiryTimer=t}};var _=n(6634),T=n(25618);const C={client:{logo:"",name:"",clientId:"",phoneNumber:"",permissions:[],privacyPolicy:{url:"",displayText:""},termsConditions:{url:"",displayText:""},kycCheck:!1,accountLinkFooterText:"",userAgent:"",agreeCheckbox:{displayText:"",defaultCheck:!0},ageVerifyCheckbox:{url:"",displayText:""},kycMandate:!1,expiresAt:0,redirectUrl:"",minKycAge:0,kycCompleted:!0},errorMode:null,expiryTimer:null,activePaymentMethod:null,autoTopupMode:l.lF.LOADING,callbackUrl:null,isAutoTopupMandate:!1,isPostTransactionAutoTopupEnabled:!1,isPreTransactionAutoTopupEnabled:!1,isUpdatePreTrxTopupConfigSuccess:null,merchantOpaConfig:null,preTransactionMinimumTopupAmount:_.b9,preTransactionPaymentMethodList:[],updatePreTrxTopupConfigResponse:null,displayInfo:T.p.createDefault(),screenType:l.te.UNDEFINED,topupConfig:!1,isScanMode:!1,pageTitle:"",hasMultiplePPCD:!1},N={namespaced:!0,state:C,actions:S,getters:A,mutations:p}},24494:function(e,t,n){n.d(t,{c6:function(){return s},ey:function(){return c}});var i=n(5873),o=(n(89463),n(74423),n(44114),n(23500),n(62953),n(30714)),r=n(74751),a=n(84276);n(28991);class s{static createEmptyType(){return{imageUrl:(0,a.Io)("web-cashier/ic-payment-none.jpg"),title:r.A.tc("paymentMethodType.noneTopupTitle"),description:r.A.tc("paymentMethodType.noneDescription"),isActive:!1,statusLabel:""}}static createFromBffV2(e,t=!1){const n={imageUrl:"",title:"",description:"",isActive:!1,methodInfo:e};if(!e)return n;switch(e.paymentMethodType){case o.eq.CREDIT_CARD:switch(e.creditCardInfo.ccType){case o.fs.YJ_CARD:n.title=r.A.tc("paymentMethodType.creditCardYJ");break;case o.fs.PP_CARD:n.title=r.A.tc("paymentMethodType.creditCardPP");break;default:n.title=r.A.tc("paymentMethodType.creditCard");break}n.description=` ${e.creditCardInfo.last4digits}`,n.imageUrl=this.getCreditCardLogo(e),n.isActive=e.creditCardInfo.paymentMethodStatus===o.Mw.ACTIVATED;break;case o.eq.WALLET:{const{paymentMethodDescriptionInfo:t}=e;n.imageUrl=(0,a.Io)("web-cashier/ic-payment-wallet.svg"),n.title=r.A.tc("cashier.label.walletAvailableBalance"),n.description=t&&t.additionalDescription&&t.additionalDescription.text||""}break;case o.eq.BANK:case o.eq.YMONEY_BANK:n.imageUrl=e.bankInfo.bankLogoUrl||(0,a.Io)("web-cashier/ic-method-type-bank-generic.png"),n.title=e.bankInfo.bankName,n.description=e.bankInfo.bankBranchName,n.description2=`${e.bankInfo.bankAccountType===o.eB.ORDINARY?r.A.tc("paymentMethodType.bankOrdinary")+" ":""}******${e.bankInfo.bankAccountNumberLast2digits}`,n.isActive=e.bankInfo.paymentMethodStatus===o.Mw.ACTIVATED;break;case o.eq.SBID_CARRIER_BILLING:n.imageUrl=(0,a.Io)("web-cashier/softbank-icon.svg"),n.title=r.A.tc("paymentMethodType.sbidCarrierBilling"),n.statusLabel=this.paymentMethodStatusLabel(e.sbidCarrierBillingInfo?e.sbidCarrierBillingInfo.paymentMethodStatus:o.yB.OFF),n.isActive=e.sbidCarrierBillingInfo.paymentMethodStatus===o.Mw.ACTIVATED;break;case o.eq.PAY_LATER_CC:{var s,c,l;n.imageUrl=(0,a.Io)("web-cashier/ic-paylater-cc.svg"),n.title=r.A.tc("paymentMethodType.payLaterCC");let _={};var d,u,E,I,S,A,p;if(_=e.payLaterCcInfo,n.statusLabel=this.paymentMethodStatusLabel(_.paymentMethodStatus||o.yB.OFF),n.isActive=_.paymentMethodStatus===o.Mw.ACTIVATED,n.ppcdInfo={availableAmount:null!==(s=null===e||void 0===e||null===(c=e.paymentMethodDescriptionInfo)||void 0===c||null===(l=c.additionalDescription)||void 0===l?void 0:l.text)&&void 0!==s?s:""},t)n.ppcdInfo=(0,i.A)((0,i.A)({},n.ppcdInfo),{},{brand:null===(d=e.payLaterCcInfo)||void 0===d?void 0:d.linkedCardBrand,brandLogo:this.getCreditCardBrandLogo(null===(u=e.payLaterCcInfo)||void 0===u?void 0:u.linkedCardBrand),cardNumber:"**** "+(null!==(E=null===(I=e.payLaterCcInfo)||void 0===I?void 0:I.last4digits)&&void 0!==E?E:""),typeLogo:this.getPPCDTypeIcon(null===(S=e.payLaterCcInfo)||void 0===S?void 0:S.linkedCardType),cardName:null!==(A=null===(p=e.payLaterCcInfo)||void 0===p?void 0:p.cardName)&&void 0!==A?A:""})}break}return n}static getPPCDTypeIcon(e){let t="";switch(e){case o._3.REGULAR:t=(0,a.Io)("web-cashier/icon-ppcd-regular.svg");break;case o._3.GOLD:t=(0,a.Io)("web-cashier/icon-ppcd-gold.svg");break}return t}static getCreditCardBrandLogo(e){let t="";switch(e){case"A":t=(0,a.Io)("web-cashier/ic-payment-amex.svg");break;case"M":case"MASTER":t=(0,a.Io)("web-cashier/ic-payment-master.svg");break;case"V":case"VISA":t=(0,a.Io)("web-cashier/ic-payment-visa.svg");break;case"J":case"JCB":t=(0,a.Io)("web-cashier/ic-payment-jcb.svg");break;case"O":t=(0,a.Io)("web-cashier/ic-payment-discover.svg");break}return t}static getCreditCardLogo(e){let t=this.getCreditCardBrandLogo(e.creditCardInfo.brand);if(null!==e.creditCardInfo.ccType)switch(e.creditCardInfo.ccType){case o.fs.YJ_CARD:t=(0,a.Io)("web-cashier/ic-payment-yj-card.svg");break;case o.fs.PP_CARD:t=(0,a.Io)("web-cashier/ic-payment-pp-card.svg");break}return t}static paymentMethodStatusLabel(e){return e===o.yB.ACTIVATED?"":r.A.tc("paymentMethodStatus.off")}}class c{static sortPaymentMethodByPriority(e){if(!e||!e.length)return[];const t=[],n=[o.eq.BANK,o.eq.YMONEY_BANK,o.eq.PAY_LATER_CC,o.eq.CREDIT_CARD,o.eq.SBID_CARRIER_BILLING],i={[o.eq.BANK]:[],[o.eq.YMONEY_BANK]:[],[o.eq.PAY_LATER_CC]:[],[o.eq.CREDIT_CARD]:[],[o.eq.SBID_CARRIER_BILLING]:[]};return e.forEach((e=>{n.includes(e.paymentMethodType)&&i[e.paymentMethodType].push(e)})),n.forEach((e=>t.push(...i[e]))),t}static getActivePaymentMethod(e,t){if(e)return 1===e.length?e[0]:t?e.find((e=>e.paymentMethodIdString===t)):this.sortPaymentMethodByPriority(e)[0]}static hasAnyActivePaymentMethod(e){return e.some((e=>{switch(e.paymentMethodType){case o.eq.CREDIT_CARD:return e.creditCardInfo.paymentMethodStatus===o.Mw.ACTIVATED&&!0===e.creditCardInfo.isAuthenticated;case o.eq.BANK:case o.eq.YMONEY_BANK:return e.bankInfo.paymentMethodStatus===o.Mw.ACTIVATED;case o.eq.SBID_CARRIER_BILLING:return e.sbidCarrierBillingInfo.paymentMethodStatus===o.Mw.ACTIVATED;case o.eq.PAY_LATER_CC:{let t={};return t=e.payLaterCcInfo,t.paymentMethodStatus===o.Mw.ACTIVATED}}}))}static filterUnAuthenticatedCreditCard(e){return e.filter((e=>e.paymentMethodType!==o.eq.CREDIT_CARD||e.creditCardInfo.isAuthenticated))}}},28991:function(e,t,n){var i,o,r,a;n.d(t,{b5:function(){return a},bX:function(){return o},lF:function(){return i},te:function(){return r}}),function(e){e["LOADING"]="LOADING",e["AUTO_TOPUP_DISABLED_WITH_NO_PAYMENT_METHOD"]="AUTO_TOPUP_DISABLED_WITH_NO_PAYMENT_METHOD",e["AUTO_TOPUP_DISABLED_WITH_PAYMENT_METHOD"]="AUTO_TOPUP_DISABLED_WITH_PAYMENT_METHOD",e["OLD_VERSION"]="OLD_VERSION",e["NEW_VERSION"]="NEW_VERSION"}(i||(i={})),function(e){e["MANDATED"]="MANDATED",e["NOT_MANDATED"]="NOT_MANDATED"}(o||(o={})),function(e){e["APP"]="APP",e["DESKTOP"]="DESKTOP",e["MOBILE"]="MOBILE",e["UNDEFINED"]="UNDEFINED"}(r||(r={})),function(e){e["ACTIVE"]="ACTIVE",e["INACTIVE"]="INACTIVE",e["REVIEWING"]="REVIEWING"}(a||(a={}))}}]);